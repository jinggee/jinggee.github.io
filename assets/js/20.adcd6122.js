(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{582:function(e,n,t){"use strict";t.r(n);var a=t(13),o=Object(a.a)({},(function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("p",[t("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/eba36c6f269a4489b0229fbb2519d409~tplv-k3u1fbpfcp-zoom-crop-mark:1304:1304:1304:734.awebp?",alt:"image"}})]),e._v(" "),t("h2",{attrs:{id:"å†™åœ¨å‰è¾¹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å†™åœ¨å‰è¾¹"}},[e._v("#")]),e._v(" å†™åœ¨å‰è¾¹")]),e._v(" "),t("p",[e._v("Webpackåœ¨å‰ç«¯å‰ç«¯æ„å»ºå·¥å…·ä¸­å¯ä»¥å ªç§°ä¸­æµç ¥æŸ±èˆ¬çš„å­˜åœ¨ï¼Œæ—¥å¸¸ä¸šåŠ¡å¼€å‘ã€å‰ç«¯åŸºå»ºå·¥å…·ã€é«˜çº§å‰ç«¯é¢è¯•...ä»»ä½•åœºæ™¯éƒ½ä¼šå‡ºç°å®ƒçš„èº«å½±ã€‚\nä¹Ÿè®¸å¯¹äºå®ƒçš„å†…éƒ¨å®ç°æœºåˆ¶ä½ ä¹Ÿè®¸ä¼šæ„Ÿåˆ°ç–‘æƒ‘ï¼Œæ—¥å¸¸å·¥ä½œä¸­åŸºäºWebpack Plugin/Loaderä¹‹ç±»æŸ¥é˜…APIä»ç„¶ä¸æ˜ç™½å„ä¸ªå‚æ•°çš„å«ä¹‰å’Œåº”ç”¨æ–¹å¼ã€‚\nå…¶å®è¿™ä¸€åˆ‡åŸå› æœ¬è´¨ä¸Šéƒ½æ˜¯åŸºäºWebpackå·¥ä½œæµæ²¡æœ‰ä¸€ä¸ªæ¸…æ™°çš„è®¤çŸ¥å¯¼è‡´äº†æ‰€è°“çš„â€œé¢å¯¹APIæ— ä»ä¸‹æ‰‹â€å¼€å‘ã€‚\næ–‡ç« ä¸­æˆ‘ä»¬ä¼šä»å¦‚ä½•å®ç°æ¨¡å—åˆ†æé¡¹ç›®æ‰“åŒ…çš„è§’åº¦å‡ºå‘ï¼Œä½¿ç”¨æœ€é€šä¿—ï¼Œæœ€ç®€æ´ï¼Œæœ€æ˜äº†çš„ä»£ç å¸¦ä½ æ­å¼€WebpackèƒŒåçš„ç¥ç§˜é¢çº±ï¼Œå¸¦ä½ å®ç°ä¸€ä¸ªç®€æ˜“ç‰ˆWebpackï¼Œä»æ­¤å¯¹äºä»»ä½•webpackç›¸å…³åº•å±‚å¼€å‘äº†ç„¶äºèƒ¸ã€‚\nè¿™é‡Œæˆ‘ä»¬åªè®²ã€Œå¹²è´§ã€ï¼Œç”¨æœ€é€šä¿—æ˜“æ‡‚çš„ä»£ç å¸¦ä½ èµ°è¿›webpackçš„å·¥ä½œæµã€‚")]),e._v(" "),t("h2",{attrs:{id:"æˆ‘å¸Œæœ›ä½ èƒ½æŒæ¡çš„å‰ç½®çŸ¥è¯†"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æˆ‘å¸Œæœ›ä½ èƒ½æŒæ¡çš„å‰ç½®çŸ¥è¯†"}},[e._v("#")]),e._v(" æˆ‘å¸Œæœ›ä½ èƒ½æŒæ¡çš„å‰ç½®çŸ¥è¯†")]),e._v(" "),t("ul",[t("li",[e._v("Tapable")])]),e._v(" "),t("p",[e._v("TapableåŒ…æœ¬è´¨ä¸Šæ˜¯ä¸ºæˆ‘ä»¬æ›´æ–¹é¢åˆ›å»ºè‡ªå®šä¹‰äº‹ä»¶å’Œè§¦å‘è‡ªå®šä¹‰äº‹ä»¶çš„åº“ï¼Œç±»ä¼¼äºNodejsä¸­çš„EventEmitter Apiã€‚\nWebpackä¸­çš„æ’ä»¶æœºåˆ¶å°±æ˜¯åŸºäºTapableå®ç°ä¸æ‰“åŒ…æµç¨‹è§£è€¦ï¼Œæ’ä»¶çš„æ‰€æœ‰å½¢å¼éƒ½æ˜¯åŸºäºTapableå®ç°ã€‚")]),e._v(" "),t("ul",[t("li",[e._v("Webpack Node Api")])]),e._v(" "),t("p",[e._v("åŸºäºå­¦ä¹ ç›®çš„æˆ‘ä»¬ä¼šç€é‡äºWebpack Node Apiæµç¨‹å»è®²è§£ï¼Œå®é™…ä¸Šæˆ‘ä»¬åœ¨å‰ç«¯æ—¥å¸¸ä½¿ç”¨çš„npm run buildå‘½ä»¤ä¹Ÿæ˜¯é€šè¿‡ç¯å¢ƒå˜é‡è°ƒç”¨binè„šæœ¬å»è°ƒç”¨Node Apiå»æ‰§è¡Œç¼–è¯‘æ‰“åŒ…ã€‚")]),e._v(" "),t("ul",[t("li",[e._v("Babel")])]),e._v(" "),t("p",[e._v("Webpackå†…éƒ¨çš„ASTåˆ†æåŒæ ·ä¾èµ–äºBabelè¿›è¡Œå¤„ç†ï¼Œå¦‚æœä½ å¯¹Babelä¸æ˜¯å¾ˆç†Ÿæ‚‰ã€‚æˆ‘å»ºè®®ä½ å¯ä»¥å…ˆå»é˜…è¯»ä¸‹è¿™ä¸¤ç¯‡æ–‡ç« ã€Œå‰ç«¯åŸºå»ºã€å¸¦ä½ åœ¨Babelçš„ä¸–ç•Œä¸­ç•…æ¸¸ã€# ä»Tree Shakingæ¥èµ°è¿›Babelæ’ä»¶å¼€å‘è€…çš„ä¸–ç•Œã€‚")]),e._v(" "),t("blockquote",[t("p",[e._v("å½“ç„¶åç»­æˆ‘ä¹Ÿä¼šå»è¯¦è§£è¿™äº›å†…å®¹åœ¨Webpackä¸­çš„åº”ç”¨ï¼Œä½†æ˜¯æˆ‘æ›´åŠ å¸Œæœ›åœ¨é˜…è¯»æ–‡ç« ä¹‹å‰ä½ å¯ä»¥å»ç‚¹ä¸€ç‚¹ä¸Šæ–¹çš„æ–‡æ¡£ç¨å¾®äº†è§£ä¸€ä¸‹å‰ç½®çŸ¥è¯†ã€‚")])]),e._v(" "),t("h2",{attrs:{id:"æµç¨‹æ¢³ç†"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æµç¨‹æ¢³ç†"}},[e._v("#")]),e._v(" æµç¨‹æ¢³ç†")]),e._v(" "),t("p",[e._v("åœ¨å¼€å§‹ä¹‹å‰æˆ‘ä»¬å…ˆå¯¹äºæ•´ä¸ªæ‰“åŒ…æµç¨‹è¿›è¡Œä¸€æ¬¡æ¢³ç†ã€‚\nè¿™é‡Œä»…ä»…æ˜¯ä¸€ä¸ªå…¨æµç¨‹çš„æ¢³ç†ï¼Œç°åœ¨ä½ æ²¡æœ‰å¿…è¦éå¸¸è¯¦ç»†çš„å»æ€è€ƒæ¯ä¸€ä¸ªæ­¥éª¤å‘ç”Ÿäº†ä»€ä¹ˆï¼Œæˆ‘ä»¬ä¼šåœ¨æ¥ä¸‹æ¥çš„æ­¥éª¤ä¸­å»ä¸€æ­¥ä¸€æ­¥å¸¦ä½ ä¸²è”å®ƒä»¬ã€‚")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b1c757a6c9c6416e93dde9db73431e83~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?",alt:"image"}})]),e._v(" "),t("p",[e._v("æ•´ä½“æˆ‘ä»¬å°†ä¼šä»ä¸Šè¾¹5ä¸ªæ–¹é¢æ¥åˆ†æ==Webpack==æ‰“åŒ…æµç¨‹:")]),e._v(" "),t("ol",[t("li",[t("p",[t("strong",[e._v("åˆå§‹åŒ–å‚æ•°é˜¶æ®µ")]),e._v("ã€‚\nè¿™ä¸€æ­¥ä¼šä»æˆ‘ä»¬é…ç½®çš„webpack.config.jsä¸­è¯»å–åˆ°å¯¹åº”çš„é…ç½®å‚æ•°å’Œshellå‘½ä»¤ä¸­ä¼ å…¥çš„å‚æ•°è¿›è¡Œåˆå¹¶å¾—åˆ°æœ€ç»ˆæ‰“åŒ…é…ç½®å‚æ•°ã€‚")])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("å¼€å§‹ç¼–è¯‘å‡†å¤‡é˜¶æ®µ")]),e._v("\nè¿™ä¸€æ­¥æˆ‘ä»¬ä¼šé€šè¿‡è°ƒç”¨webpack()æ–¹æ³•è¿”å›ä¸€ä¸ªcompileræ–¹æ³•ï¼Œåˆ›å»ºæˆ‘ä»¬çš„compilerå¯¹è±¡ï¼Œå¹¶ä¸”æ³¨å†Œå„ä¸ªWebpack Pluginã€‚æ‰¾åˆ°é…ç½®å…¥å£ä¸­çš„entryä»£ç ï¼Œè°ƒç”¨compiler.run()æ–¹æ³•è¿›è¡Œç¼–è¯‘ã€‚")])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("æ¨¡å—ç¼–è¯‘é˜¶æ®µ")]),e._v("\nä»å…¥å£æ¨¡å—è¿›è¡Œåˆ†æï¼Œè°ƒç”¨åŒ¹é…æ–‡ä»¶çš„loaderså¯¹æ–‡ä»¶è¿›è¡Œå¤„ç†ã€‚åŒæ—¶åˆ†ææ¨¡å—ä¾èµ–çš„æ¨¡å—ï¼Œé€’å½’è¿›è¡Œæ¨¡å—ç¼–è¯‘å·¥ä½œã€‚")])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("å®Œæˆç¼–è¯‘é˜¶æ®µ")]),e._v("\nåœ¨é€’å½’å®Œæˆåï¼Œæ¯ä¸ªå¼•ç”¨æ¨¡å—é€šè¿‡loaderså¤„ç†å®ŒæˆåŒæ—¶å¾—åˆ°æ¨¡å—ä¹‹é—´çš„ç›¸äº’ä¾èµ–å…³ç³»ã€‚")])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("è¾“å‡ºæ–‡ä»¶é˜¶æ®µ")]),e._v("\næ•´ç†æ¨¡å—ä¾èµ–å…³ç³»ï¼ŒåŒæ—¶å°†å¤„ç†åçš„æ–‡ä»¶è¾“å‡ºåˆ°ouputçš„ç£ç›˜ç›®å½•ä¸­ã€‚")])])]),e._v(" "),t("p",[e._v("æ¥ä¸‹æ¥è®©æˆ‘ä»¬è¯¦ç»†çš„å»æ¢ç´¢æ¯ä¸€æ­¥ç©¶ç«Ÿå‘ç”Ÿäº†ä»€ä¹ˆã€‚")]),e._v(" "),t("h2",{attrs:{id:"åˆ›å»ºç›®å½•"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»ºç›®å½•"}},[e._v("#")]),e._v(" åˆ›å»ºç›®å½•")]),e._v(" "),t("p",[e._v("å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€‚é¦–å…ˆè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè‰¯å¥½çš„ç›®å½•æ¥ç®¡ç†æˆ‘ä»¬éœ€è¦å®ç°çš„Packing toolå§ï¼\nè®©æˆ‘ä»¬æ¥åˆ›å»ºè¿™æ ·ä¸€ä¸ªç›®å½•:\n"),t("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/936fa765f22542be8c49159fc9feaf38~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?",alt:"image"}})]),e._v(" "),t("ul",[t("li",[t("p",[e._v("webpack/coreå­˜æ”¾æˆ‘ä»¬è‡ªå·±å°†è¦å®ç°çš„webpackæ ¸å¿ƒä»£ç ã€‚")])]),e._v(" "),t("li",[t("p",[e._v("webpack/exampleå­˜æ”¾æˆ‘ä»¬å°†ç”¨æ¥æ‰“åŒ…çš„å®ä¾‹é¡¹ç›®ã€‚")]),e._v(" "),t("ul",[t("li",[e._v("webpack/example/webpak.config.jsé…ç½®æ–‡ä»¶.")]),e._v(" "),t("li",[e._v("webpack/example/src/entry1ç¬¬ä¸€ä¸ªå…¥å£æ–‡ä»¶")]),e._v(" "),t("li",[e._v("webpack/example/src/entry1ç¬¬äºŒä¸ªå…¥å£æ–‡ä»¶")]),e._v(" "),t("li",[e._v("webpack/example/src/index.jsæ¨¡å—æ–‡ä»¶")])])]),e._v(" "),t("li",[t("p",[e._v("webpack/loaderså­˜æ”¾æˆ‘ä»¬çš„è‡ªå®šä¹‰loaderã€‚")])]),e._v(" "),t("li",[t("p",[e._v("webpack/pluginså­˜æ”¾æˆ‘ä»¬çš„è‡ªå®šä¹‰pluginã€‚")])])]),e._v(" "),t("h2",{attrs:{id:"åˆå§‹åŒ–å‚æ•°é˜¶æ®µ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åˆå§‹åŒ–å‚æ•°é˜¶æ®µ"}},[e._v("#")]),e._v(" åˆå§‹åŒ–å‚æ•°é˜¶æ®µ")]),e._v(" "),t("p",[e._v("å¾€å¾€ï¼Œæˆ‘ä»¬åœ¨æ—¥å¸¸ä½¿ç”¨é˜¶æ®µæœ‰ä¸¤ç§æ–¹å¼å»ç»™webpackä¼ é€’æ‰“åŒ…å‚æ•°ï¼Œè®©æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å¦‚ä½•ä¼ é€’å‚æ•°:")]),e._v(" "),t("h3",{attrs:{id:"cliå‘½ä»¤è¡Œä¼ é€’å‚æ•°"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cliå‘½ä»¤è¡Œä¼ é€’å‚æ•°"}},[e._v("#")]),e._v(" Cliå‘½ä»¤è¡Œä¼ é€’å‚æ•°")]),e._v(" "),t("p",[e._v("é€šå¸¸ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨è°ƒç”¨webpackå‘½ä»¤æ—¶ï¼Œæœ‰æ—¶ä¼šä¼ å…¥ä¸€å®šå‘½ä»¤è¡Œå‚æ•°ï¼Œæ¯”å¦‚:")]),e._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[e._v("webpack "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("--")]),e._v("mode"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("production\n# è°ƒç”¨webpackå‘½ä»¤æ‰§è¡Œæ‰“åŒ… åŒæ—¶ä¼ å…¥modeä¸ºproduction\n")])])]),t("h3",{attrs:{id:"webpack-config-jsä¼ é€’å‚æ•°"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#webpack-config-jsä¼ é€’å‚æ•°"}},[e._v("#")]),e._v(" webpack.config.jsä¼ é€’å‚æ•°")]),e._v(" "),t("p",[e._v("å¦ä¸€ç§æ–¹å¼ï¼Œæˆ‘ç›¸ä¿¡å°±æ›´åŠ è€ç”Ÿå¸¸è°ˆäº†ã€‚")]),e._v(" "),t("p",[e._v("æˆ‘ä»¬åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ä½¿ç”¨webpack.config.jså¯¼å‡ºä¸€ä¸ªå¯¹è±¡è¿›è¡Œwebpacké…ç½®:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("const path = require('path')\n\n// å¼•å…¥loaderå’Œplugin ...\nmodule.exports = {\n  mode: 'development',\n  entry: {\n    main: path.resolve(__dirname, './src/entry1.js'),\n    second: path.resolve(__dirname, './src/entry2.js'),\n  },\n  devtool: false,\n  // åŸºç¡€ç›®å½•ï¼Œç»å¯¹è·¯å¾„ï¼Œç”¨äºä»é…ç½®ä¸­è§£æå…¥å£ç‚¹(entry point)å’Œ åŠ è½½å™¨(loader)ã€‚\n  // æ¢è€Œè¨€ä¹‹entryå’Œloaderçš„æ‰€æœ‰ç›¸å¯¹è·¯å¾„éƒ½æ˜¯ç›¸å¯¹äºè¿™ä¸ªè·¯å¾„è€Œè¨€çš„\n  context: process.cwd(),\n  output: {\n    path: path.resolve(__dirname, './build'),\n    filename: '[name].js',\n  },\n  plugins: [new PluginA(), new PluginB()],\n  resolve: {\n    extensions: ['.js', '.ts'],\n  },\n  module: {\n    rules: [\n      {\n        test: /\\.js/,\n        use: [\n          // ä½¿ç”¨è‡ªå·±loaderæœ‰ä¸‰ç§æ–¹å¼ è¿™é‡Œä»…ä»…æ˜¯ä¸€ç§\n          path.resolve(__dirname, '../loaders/loader-1.js'),\n          path.resolve(__dirname, '../loaders/loader-2.js'),\n        ],\n      },\n    ],\n  },\n};\n")])])]),t("p",[e._v("åŒæ—¶è¿™ä»½é…ç½®æ–‡ä»¶ä¹Ÿæ˜¯æˆ‘ä»¬éœ€è¦ä½œä¸ºå®ä¾‹é¡¹ç›®exampleä¸‹çš„å®ä¾‹é…ç½®ï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬ä¿®æ”¹example/webpack.config.jsä¸­çš„å†…å®¹ä¸ºä¸Šè¿°é…ç½®å§ã€‚")]),e._v(" "),t("blockquote",[t("p",[e._v("å½“ç„¶è¿™é‡Œçš„loaderå’Œpluginç›®å‰ä½ å¯ä»¥ä¸ç”¨ç†è§£ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä¼šé€æ­¥å®ç°è¿™äº›ä¸œè¥¿å¹¶ä¸”æ·»åŠ åˆ°æˆ‘ä»¬çš„æ‰“åŒ…æµç¨‹ä¸­å»ã€‚")])]),e._v(" "),t("h2",{attrs:{id:"å®ç°åˆå¹¶å‚æ•°é˜¶æ®µ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å®ç°åˆå¹¶å‚æ•°é˜¶æ®µ"}},[e._v("#")]),e._v(" å®ç°åˆå¹¶å‚æ•°é˜¶æ®µ")]),e._v(" "),t("p",[e._v("è¿™ä¸€æ­¥ï¼Œè®©æˆ‘ä»¬çœŸæ­£å¼€å§‹åŠ¨æ‰‹å®ç°æˆ‘ä»¬çš„webpackå§ï¼")]),e._v(" "),t("p",[e._v("é¦–å…ˆè®©æˆ‘ä»¬åœ¨webpack/coreä¸‹æ–°å»ºä¸€ä¸ªindex.jsæ–‡ä»¶ä½œä¸ºæ ¸å¿ƒå…¥å£æ–‡ä»¶ã€‚")]),e._v(" "),t("p",[e._v("åŒæ—¶å»ºç«‹ä¸€ä¸ªwebpack/coreä¸‹æ–°å»ºä¸€ä¸ªwebpack.jsæ–‡ä»¶ä½œä¸ºwebpack()æ–¹æ³•çš„å®ç°æ–‡ä»¶ã€‚")]),e._v(" "),t("p",[e._v("é¦–å…ˆï¼Œæˆ‘ä»¬æ¸…æ¥šåœ¨NodeJs Apiä¸­æ˜¯é€šè¿‡webpack()æ–¹æ³•å»å¾—åˆ°compilerå¯¹è±¡çš„ã€‚\n"),t("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/136db48b37774dad92b87c2009495500~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?",alt:"image"}})]),e._v(" "),t("p",[e._v("æ­¤æ—¶è®©æˆ‘ä»¬æŒ‰ç…§åŸæœ¬çš„webpackæ¥å£æ ¼å¼æ¥è¡¥å……ä¸€ä¸‹index.jsä¸­çš„é€»è¾‘:")]),e._v(" "),t("ul",[t("li",[e._v("æˆ‘ä»¬éœ€è¦ä¸€ä¸ªwebpackæ–¹æ³•å»æ‰§è¡Œè°ƒç”¨å‘½ä»¤ã€‚")]),e._v(" "),t("li",[e._v("åŒæ—¶æˆ‘ä»¬å¼•å…¥webpack.config.jsé…ç½®æ–‡ä»¶ä¼ å…¥webpackæ–¹æ³•ã€‚")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("// index.js\nconst webpack = require('./webpack');\nconst config = require('../example/webpack.config');\n// æ­¥éª¤1: åˆå§‹åŒ–å‚æ•° æ ¹æ®é…ç½®æ–‡ä»¶å’Œshellå‚æ•°åˆæˆå‚æ•°\nconst compiler = webpack(config);\n")])])]),t("p",[e._v("å—¯ï¼Œçœ‹èµ·æ¥è¿˜ä¸é”™ã€‚==æ¥ä¸‹æ¥è®©æˆ‘ä»¬å»å®ç°ä¸€ä¸‹webpack==.js:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("function webpack(options) {\n  // åˆå¹¶å‚æ•° å¾—åˆ°åˆå¹¶åçš„å‚æ•° mergeOptions\n  const mergeOptions = _mergeOptions(options);\n}\n\n// åˆå¹¶å‚æ•°\nfunction _mergeOptions(options) {\n  const shellOptions = process.argv.slice(2).reduce((option, argv) => {\n    // argv -> --mode=production\n    const [key, value] = argv.split('=');\n    if (key && value) {\n      const parseKey = key.slice(2);\n      option[parseKey] = value;\n    }\n    return option;\n  }, {});\n  return { ...options, ...shellOptions };\n}\n\nmodule.exports = webpack;\n")])])]),t("p",[e._v("è¿™é‡Œæˆ‘ä»¬éœ€è¦é¢å¤–è¯´æ˜çš„æ˜¯\n==webpack==æ–‡ä»¶ä¸­éœ€è¦å¯¼å‡ºä¸€ä¸ªåä¸º==webpack==çš„æ–¹æ³•ï¼ŒåŒæ—¶æ¥å—å¤–éƒ¨ä¼ å…¥çš„é…ç½®å¯¹è±¡ã€‚è¿™ä¸ªæ˜¯æˆ‘ä»¬åœ¨ä¸Šè¿°è®²è¿°è¿‡çš„ã€‚")]),e._v(" "),t("p",[e._v("å½“ç„¶å…³äºæˆ‘ä»¬åˆå¹¶å‚æ•°çš„é€»è¾‘ï¼Œæ˜¯å°†å¤–éƒ¨ä¼ å…¥çš„å¯¹è±¡å’Œæ‰§è¡Œshellæ—¶çš„ä¼ å…¥å‚æ•°è¿›è¡Œæœ€ç»ˆåˆå¹¶ã€‚")]),e._v(" "),t("p",[e._v("åœ¨Node Jsä¸­æˆ‘ä»¬å¯ä»¥é€šè¿‡process.argv.slice(2)æ¥è·å¾—shellå‘½ä»¤ä¸­ä¼ å…¥çš„å‚æ•°ï¼Œæ¯”å¦‚:")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3e003c7741b54e5ebf1a5c90f9f96875~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?",alt:"image"}})]),e._v(" "),t("p",[e._v("å½“ç„¶_mergeOptionsæ–¹æ³•å°±æ˜¯ä¸€ä¸ªç®€å•çš„åˆå¹¶é…ç½®å‚æ•°çš„æ–¹æ³•ï¼Œç›¸ä¿¡å¯¹äºå¤§å®¶æ¥è¯´å°±æ˜¯å°èœä¸€ç¢Ÿã€‚\næ­å–œå¤§å®¶ğŸ‰ï¼Œåƒé‡Œä¹‹è¡Œå§‹äºè¶³ä¸‹ã€‚è¿™ä¸€æ­¥æˆ‘ä»¬å·²ç»å®Œæˆäº†æ‰“åŒ…æµç¨‹ä¸­çš„ç¬¬ä¸€æ­¥ï¼šåˆå¹¶é…ç½®å‚æ•°ã€‚")]),e._v(" "),t("h2",{attrs:{id:"ç¼–è¯‘é˜¶æ®µ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç¼–è¯‘é˜¶æ®µ"}},[e._v("#")]),e._v(" ç¼–è¯‘é˜¶æ®µ")]),e._v(" "),t("p",[e._v("åœ¨å¾—åˆ°æœ€ç»ˆçš„é…ç½®å‚æ•°ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦åœ¨webpack()å‡½æ•°ä¸­åšä»¥ä¸‹å‡ ä»¶äº‹æƒ…:")]),e._v(" "),t("ul",[t("li",[e._v("é€šè¿‡å‚æ•°åˆ›å»ºcompilerå¯¹è±¡ã€‚æˆ‘ä»¬çœ‹åˆ°å®˜æ–¹æ¡ˆä¾‹ä¸­é€šè¿‡è°ƒç”¨webpack(options)æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªcompilerå¯¹è±¡ã€‚å¹¶ä¸”åŒæ—¶è°ƒç”¨compiler.run()æ–¹æ³•å¯åŠ¨çš„ä»£ç è¿›è¡Œæ‰“åŒ…ã€‚")]),e._v(" "),t("li",[e._v("æ³¨å†Œæˆ‘ä»¬å®šä¹‰çš„webpack pluginæ’ä»¶ã€‚")]),e._v(" "),t("li",[e._v("æ ¹æ®ä¼ å…¥çš„é…ç½®å¯¹è±¡å¯»æ‰¾å¯¹åº”çš„æ‰“åŒ…å…¥å£æ–‡ä»¶ã€‚")])]),e._v(" "),t("h3",{attrs:{id:"åˆ›å»ºcompilerå¯¹è±¡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»ºcompilerå¯¹è±¡"}},[e._v("#")]),e._v(" åˆ›å»ºcompilerå¯¹è±¡")]),e._v(" "),t("p",[e._v("è®©æˆ‘ä»¬å…ˆæ¥å®Œæˆindex.jsä¸­çš„é€»è¾‘ä»£ç è¡¥å…¨:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("// index.js\nconst webpack = require('./webpack');\nconst config = require('../example/webpack.config');\n// æ­¥éª¤1: åˆå§‹åŒ–å‚æ•° æ ¹æ®é…ç½®æ–‡ä»¶å’Œshellå‚æ•°åˆæˆå‚æ•°\n// æ­¥éª¤2: è°ƒç”¨Webpack(options) åˆå§‹åŒ–compilerå¯¹è±¡  \n// webpack()æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªcompilerå¯¹è±¡\n\nconst compiler = webpack(config);\n\n// è°ƒç”¨runæ–¹æ³•è¿›è¡Œæ‰“åŒ…\ncompiler.run((err, stats) => {\n  if (err) {\n    console.log(err, 'err');\n  }\n  // ...\n});\n")])])]),t("p",[e._v("å¯ä»¥çœ‹åˆ°ï¼Œæ ¸å¿ƒç¼–è¯‘å®ç°åœ¨äºwebpack()æ–¹æ³•è¿”å›çš„compiler.run()æ–¹æ³•ä¸Šã€‚\nä¸€æ­¥ä¸€æ­¥è®©æˆ‘ä»¬æ¥å®Œå–„è¿™ä¸ªwebpack()æ–¹æ³•ï¼š")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("// webpack.js\nfunction webpack(options) {\n  // åˆå¹¶å‚æ•° å¾—åˆ°åˆå¹¶åçš„å‚æ•° mergeOptions\n  const mergeOptions = _mergeOptions(options);\n  // åˆ›å»ºcompilerå¯¹è±¡\n  const compiler = new Compiler(mergeOptions)\n  \n  return compiler\n}\n\n// ...\n")])])]),t("p",[e._v("è®©æˆ‘ä»¬åœ¨webpack/coreç›®å½•ä¸‹åŒæ ·æ–°å»ºä¸€ä¸ªcompiler.jsæ–‡ä»¶ï¼Œä½œä¸ºcompilerçš„æ ¸å¿ƒå®ç°æ–‡ä»¶:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("// compiler.js\n// Compilerç±»è¿›è¡Œæ ¸å¿ƒç¼–è¯‘å®ç°\nclass Compiler {\n  constructor(options) {\n    this.options = options;\n  }\n\n  // runæ–¹æ³•å¯åŠ¨ç¼–è¯‘ \n  // åŒæ—¶runæ–¹æ³•æ¥å—å¤–éƒ¨ä¼ é€’çš„callback\n  run(callback) {\n  }\n}\n\nmodule.exports = Compiler\n")])])]),t("p",[e._v("æ­¤æ—¶æˆ‘ä»¬çš„Compilerç±»å°±å…ˆæ­å»ºä¸€ä¸ªåŸºç¡€çš„éª¨æ¶ä»£ç ã€‚\nç›®å‰ï¼Œæˆ‘ä»¬æ‹¥æœ‰äº†:")]),e._v(" "),t("ul",[t("li",[e._v("webpack/core/index.jsä½œä¸ºæ‰“åŒ…å‘½ä»¤çš„å…¥å£æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å¼•ç”¨äº†æˆ‘ä»¬è‡ªå·±å®ç°çš„webpackåŒæ—¶å¼•ç”¨äº†å¤–éƒ¨çš„webpack.config.js(options)ã€‚è°ƒç”¨webpack(options).run()å¼€å§‹ç¼–è¯‘ã€‚")]),e._v(" "),t("li",[e._v("webpack/core/webpack.jsè¿™ä¸ªæ–‡ä»¶ç›®å‰å¤„ç†äº†å‚æ•°çš„åˆå¹¶ä»¥åŠä¼ å…¥åˆå¹¶åçš„å‚æ•°new Compiler(mergeOptions)ï¼ŒåŒæ—¶è¿”å›åˆ›å»ºçš„Compilerå®åŠ›å¯¹è±¡ã€‚")]),e._v(" "),t("li",[e._v("webpack/core/compilerï¼Œæ­¤æ—¶æˆ‘ä»¬çš„compilerä»…ä»…æ˜¯ä½œä¸ºä¸€ä¸ªåŸºç¡€çš„éª¨æ¶ï¼Œå­˜åœ¨ä¸€ä¸ªrun()å¯åŠ¨æ–¹æ³•ã€‚")])]),e._v(" "),t("h3",{attrs:{id:"ç¼–å†™plugin"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç¼–å†™plugin"}},[e._v("#")]),e._v(" ç¼–å†™Plugin")]),e._v(" "),t("p",[e._v("è¿˜è®°å¾—æˆ‘ä»¬åœ¨webpack.config.jsä¸­ä½¿ç”¨äº†ä¸¤ä¸ªplugin---pluginAã€pluginBæ’ä»¶å—ã€‚æ¥ä¸‹æ¥è®©æˆ‘ä»¬æ¥ä¾æ¬¡å®ç°å®ƒä»¬:")]),e._v(" "),t("p",[e._v("åœ¨å®ç°Pluginå‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ¥å®Œå–„ä¸€ä¸‹compileræ–¹æ³•:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("const { SyncHook } = require('tapable');\n\nclass Compiler {\n  constructor(options) {\n    this.options = options;\n    // åˆ›å»ºplugin hooks\n    this.hooks = {\n      // å¼€å§‹ç¼–è¯‘æ—¶çš„é’©å­\n      run: new SyncHook(),\n      // è¾“å‡º asset åˆ° output ç›®å½•ä¹‹å‰æ‰§è¡Œ (å†™å…¥æ–‡ä»¶ä¹‹å‰)\n      emit: new SyncHook(),\n      // åœ¨ compilation å®Œæˆæ—¶æ‰§è¡Œ å…¨éƒ¨å®Œæˆç¼–è¯‘æ‰§è¡Œ\n      done: new SyncHook(),\n    };\n  }\n\n  // runæ–¹æ³•å¯åŠ¨ç¼–è¯‘\n  // åŒæ—¶runæ–¹æ³•æ¥å—å¤–éƒ¨ä¼ é€’çš„callback\n  run(callback) {}\n}\n\nmodule.exports = Compiler;\n")])])]),t("p",[e._v("è¿™é‡Œï¼Œæˆ‘ä»¬åœ¨Compilerè¿™ä¸ªç±»çš„æ„é€ å‡½æ•°ä¸­åˆ›å»ºäº†ä¸€ä¸ªå±æ€§hooksï¼Œå®ƒçš„å€¼æ˜¯ä¸‰ä¸ªå±æ€§runã€emitã€doneã€‚")]),e._v(" "),t("p",[e._v("å…³äºè¿™ä¸‰ä¸ªå±æ€§çš„å€¼å°±æ˜¯æˆ‘ä»¬ä¸Šæ–‡æåˆ°å‰ç½®çŸ¥è¯†çš„tapableçš„SyncHookæ–¹æ³•ï¼Œæœ¬è´¨ä¸Šä½ å¯ä»¥ç®€å•å°†SyncHook()æ–¹æ³•ç†è§£ç§°ä¸ºä¸€ä¸ªEmitter Eventç±»ã€‚\nå½“æˆ‘ä»¬é€šè¿‡new SyncHook()è¿”å›ä¸€ä¸ªå¯¹è±¡å®ä¾‹åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡this.hook.run.tap('name',callback)æ–¹æ³•ä¸ºè¿™ä¸ªå¯¹è±¡ä¸Šæ·»åŠ äº‹ä»¶ç›‘å¬ï¼Œç„¶ååœ¨é€šè¿‡this.hook.run.call()æ‰§è¡Œæ‰€æœ‰tapæ³¨å†Œçš„äº‹ä»¶ã€‚")]),e._v(" "),t("blockquote",[t("p",[e._v("å½“ç„¶webpackçœŸå®æºç ä¸­ï¼Œè¿™é‡Œæœ‰éå¸¸å¤šçš„hookã€‚ä»¥åŠåˆ†åˆ«å­˜åœ¨åŒæ­¥/å¼‚æ­¥é’©å­ï¼Œæˆ‘ä»¬è¿™é‡Œæ›´å¤šçš„æ˜¯ä¸ºå¤§å®¶è®²è§£æ¸…æ¥šæµç¨‹ï¼Œæ‰€ä»¥ä»…åˆ—ä¸¾äº†ä¸‰ä¸ªå¸¸è§ä¸”ç®€å•çš„åŒæ­¥é’©å­ã€‚")])]),e._v(" "),t("p",[e._v("æ­¤æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ˜ç™½ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡Compilerç±»è¿”å›çš„å®ä¾‹å¯¹è±¡ä¸Šcompiler.hooks.run.tapæ³¨å†Œé’©å­ã€‚")]),e._v(" "),t("p",[e._v("æ¥ä¸‹æ¥è®©æˆ‘ä»¬åˆ‡å›åˆ°webpack.jsä¸­ï¼Œè®©æˆ‘ä»¬æ¥å¡«å……å…³äºæ’ä»¶æ³¨å†Œçš„é€»è¾‘:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("const Compiler = require('./compiler');\n\nfunction webpack(options) {\n  // åˆå¹¶å‚æ•°\n  const mergeOptions = _mergeOptions(options);\n  // åˆ›å»ºcompilerå¯¹è±¡\n  const compiler = new Compiler(mergeOptions);\n  // åŠ è½½æ’ä»¶\n  _loadPlugin(options.plugins, compiler);\n  return compiler;\n}\n\n// åˆå¹¶å‚æ•°\nfunction _mergeOptions(options) {\n  const shellOptions = process.argv.slice(2).reduce((option, argv) => {\n    // argv -> --mode=production\n    const [key, value] = argv.split('=');\n    if (key && value) {\n      const parseKey = key.slice(2);\n      option[parseKey] = value;\n    }\n    return option;\n  }, {});\n  return { ...options, ...shellOptions };\n}\n\n// åŠ è½½æ’ä»¶å‡½æ•°\nfunction _loadPlugin(plugins, compiler) {\n  if (plugins && Array.isArray(plugins)) {\n    plugins.forEach((plugin) => {\n      plugin.apply(compiler);\n    });\n  }\n}\n\nmodule.exports = webpack;\n")])])]),t("p",[e._v("è¿™é‡Œæˆ‘ä»¬åœ¨åˆ›å»ºå®Œæˆcompilerå¯¹è±¡åï¼Œè°ƒç”¨äº†_loadPluginæ–¹æ³•è¿›è¡Œæ³¨å†Œæ’ä»¶ã€‚")]),e._v(" "),t("p",[e._v("æœ‰æ¥è§¦è¿‡webpackæ’ä»¶å¼€å‘çš„åŒå­¦ï¼Œæˆ–å¤šæˆ–å°‘å¯èƒ½éƒ½æœ‰äº†è§£è¿‡ã€‚"),t("strong",[e._v("ä»»ä½•ä¸€ä¸ªwebpackæ’ä»¶éƒ½æ˜¯ä¸€ä¸ªç±»(å½“ç„¶ç±»æœ¬è´¨ä¸Šéƒ½æ˜¯funcitonçš„è¯­æ³•ç³–)ï¼Œæ¯ä¸ªæ’ä»¶éƒ½å¿…é¡»å­˜åœ¨ä¸€ä¸ªapplyæ–¹æ³•")]),e._v("ã€‚")]),e._v(" "),t("p",[e._v("è¿™ä¸ª==applyæ–¹==æ³•ä¼šæ¥å—ä¸€ä¸ª==compiler==å¯¹è±¡ã€‚æˆ‘ä»¬ä¸Šè¾¹åšçš„å°±æ˜¯ä¾æ¬¡è°ƒç”¨ä¼ å…¥çš„pluginçš„applyæ–¹æ³•å¹¶ä¸”ä¼ å…¥æˆ‘ä»¬çš„compilerå¯¹è±¡ã€‚")]),e._v(" "),t("blockquote",[t("p",[e._v("è¿™é‡Œæˆ‘è¯·ä½ è®°ä½ä¸Šè¾¹çš„æµç¨‹ï¼Œæ—¥å¸¸æˆ‘ä»¬ç¼–å†™webpack pluginæ—¶æœ¬è´¨ä¸Šå°±æ˜¯æ“ä½œcompilerå¯¹è±¡ä»è€Œå½±å“æ‰“åŒ…ç»“æœè¿›è¡Œã€‚")])]),e._v(" "),t("blockquote",[t("p",[e._v("ä¹Ÿè®¸æ­¤æ—¶ä½ å¹¶ä¸æ˜¯å¾ˆç†è§£è¿™å¥è¯çš„å«ä¹‰ï¼Œåœ¨æˆ‘ä»¬ä¸²è”å®Œæˆæ•´ä¸ªæµç¨‹ä¹‹åæˆ‘ä¼šä¸ºå¤§å®¶æ­æ™“è¿™ä¸ªç­”æ¡ˆã€‚")])]),e._v(" "),t("p",[e._v("æ¥ä¸‹æ¥è®©æˆ‘ä»¬å»ç¼–å†™è¿™äº›ä¸ªæ’ä»¶:\nä¸äº†è§£æ’ä»¶å¼€å‘çš„åŒå­¦å¯ä»¥å»ç¨å¾®çœ‹ä¸€ä¸‹å®˜æ–¹çš„ä»‹ç»ï¼Œå…¶å®ä¸æ˜¯å¾ˆéš¾,æˆ‘ä¸ªäººå¼ºçƒˆå»ºè®®å¦‚æœä¸äº†è§£å¯ä»¥å…ˆå»çœ‹çœ‹å†å›æ¥ç»“åˆä¸Šå˜è®²çš„å†…å®¹ä½ ä¸€å®šä¼šæœ‰æ‰€æ”¶è·çš„ã€‚\né¦–å…ˆè®©æˆ‘ä»¬å…ˆåˆ›å»ºæ–‡ä»¶:\n"),t("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a53f0ccfda3d46e0adda75c20b69ea9d~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?",alt:"image"}})]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("// plugin-a.js\n// æ’ä»¶A\nclass PluginA {\n  apply(compiler) {\n    // æ³¨å†ŒåŒæ­¥é’©å­\n    // è¿™é‡Œçš„compilerå¯¹è±¡å°±æ˜¯æˆ‘ä»¬new Compiler()åˆ›å»ºçš„å®ä¾‹å“¦\n    compiler.hooks.run.tap('Plugin A', () => {\n      // è°ƒç”¨\n      console.log('PluginA');\n    });\n  }\n}\n\nmodule.exports = PluginA;\n")])])]),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("// plugin-b.js\nclass PluginB {\n  apply(compiler) {\n    compiler.hooks.done.tap('Plugin B', () => {\n      console.log('PluginB');\n    });\n  }\n}\n\nmodule.exports = PluginB;\n")])])]),t("p",[e._v("çœ‹åˆ°è¿™é‡Œæˆ‘ç›¸ä¿¡å¤§éƒ¨åˆ†åŒå­¦éƒ½å·²ç»ååº”è¿‡æ¥äº†ï¼Œcompiler.hooks.done.tapä¸å°±æ˜¯æˆ‘ä»¬ä¸Šè¾¹è®²åˆ°çš„é€šè¿‡tapableåˆ›å»ºä¸€ä¸ªSyncHookå®ä¾‹ç„¶åé€šè¿‡tapæ–¹æ³•æ³¨å†Œäº‹ä»¶å—ï¼Ÿ")]),e._v(" "),t("p",[e._v("æ²¡é”™ï¼çš„ç¡®æ˜¯è¿™æ ·ï¼Œå…³äº==webpackæ’ä»¶æœ¬è´¨ä¸Šå°±æ˜¯é€šè¿‡å‘å¸ƒè®¢é˜…çš„æ¨¡å¼ï¼Œé€šè¿‡compilerä¸Šç›‘å¬äº‹ä»¶ã€‚ç„¶åå†æ‰“åŒ…ç¼–è¯‘è¿‡ç¨‹ä¸­è§¦å‘ç›‘å¬çš„äº‹ä»¶ä»è€Œæ·»åŠ ä¸€å®šçš„é€»è¾‘å½±å“æ‰“åŒ…ç»“æœ==ã€‚")]),e._v(" "),t("p",[e._v("æˆ‘ä»¬åœ¨æ¯ä¸ªæ’ä»¶çš„applyæ–¹æ³•ä¸Šé€šè¿‡tapåœ¨ç¼–è¯‘å‡†å¤‡é˜¶æ®µ(ä¹Ÿå°±æ˜¯è°ƒç”¨webpack()å‡½æ•°æ—¶)è¿›è¡Œè®¢é˜…å¯¹åº”çš„äº‹ä»¶ï¼Œå½“æˆ‘ä»¬çš„ç¼–è¯‘æ‰§è¡Œåˆ°ä¸€å®šé˜¶æ®µæ—¶å‘å¸ƒå¯¹åº”çš„äº‹ä»¶å‘Šè¯‰è®¢é˜…è€…å»æ‰§è¡Œç›‘å¬çš„äº‹ä»¶ï¼Œä»è€Œè¾¾åˆ°åœ¨ç¼–è¯‘é˜¶æ®µçš„ä¸åŒç”Ÿå‘½å‘¨æœŸå†…å»è§¦å‘å¯¹åº”çš„pluginã€‚")]),e._v(" "),t("blockquote",[t("p",[e._v("æ‰€ä»¥è¿™é‡Œä½ åº”è¯¥æ¸…æ¥šï¼Œæˆ‘ä»¬åœ¨è¿›è¡Œwebpackæ’ä»¶å¼€å‘æ—¶ï¼Œcompilerå¯¹è±¡ä¸Šå­˜æ”¾ç€æœ¬æ¬¡æ‰“åŒ…çš„æ‰€æœ‰ç›¸å…³å±æ€§ï¼Œæ¯”å¦‚optionsæ‰“åŒ…çš„é…ç½®ï¼Œä»¥åŠæˆ‘ä»¬ä¼šåœ¨ä¹‹åè®²åˆ°çš„å„ç§å±æ€§ã€‚")])]),e._v(" "),t("h3",{attrs:{id:"å¯»æ‰¾entryå…¥å£"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å¯»æ‰¾entryå…¥å£"}},[e._v("#")]),e._v(" å¯»æ‰¾entryå…¥å£")]),e._v(" "),t("p",[e._v("è¿™ä¹‹åï¼Œæˆ‘ä»¬çš„ç»å¤§å¤šæ•°å†…å®¹éƒ½ä¼šæ”¾åœ¨compiler.jsä¸­å»å®ç°Compilerè¿™ä¸ªç±»å®ç°æ‰“åŒ…çš„æ ¸å¿ƒæµç¨‹ã€‚")]),e._v(" "),t("p",[e._v("ä»»ä½•ä¸€æ¬¡æ‰“åŒ…éƒ½éœ€è¦å…¥å£æ–‡ä»¶ï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬å°±ä»çœŸæ­£è¿›å…¥æ‰“åŒ…ç¼–è¯‘é˜¶æ®µã€‚é¦–å½“å…¶å†²çš„äº‹æƒ…å°±æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®å…¥å£é…ç½®æ–‡ä»¶è·¯å¾„å¯»æ‰¾åˆ°å¯¹åº”å…¥å£æ–‡ä»¶ã€‚")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("// compiler.js\nconst { SyncHook } = require('tapable');\nconst { toUnixPath } = require('./utils');\n\nclass Compiler {\n  constructor(options) {\n    this.options = options;\n    // ç›¸å¯¹è·¯å¾„è·Ÿè·¯å¾„ Contextå‚æ•°\n    this.rootPath = this.options.context || toUnixPath(process.cwd());\n    // åˆ›å»ºplugin hooks\n    this.hooks = {\n      // å¼€å§‹ç¼–è¯‘æ—¶çš„é’©å­\n      run: new SyncHook(),\n      // è¾“å‡º asset åˆ° output ç›®å½•ä¹‹å‰æ‰§è¡Œ (å†™å…¥æ–‡ä»¶ä¹‹å‰)\n      emit: new SyncHook(),\n      // åœ¨ compilation å®Œæˆæ—¶æ‰§è¡Œ å…¨éƒ¨å®Œæˆç¼–è¯‘æ‰§è¡Œ\n      done: new SyncHook(),\n    };\n  }\n\n  // runæ–¹æ³•å¯åŠ¨ç¼–è¯‘\n  // åŒæ—¶runæ–¹æ³•æ¥å—å¤–éƒ¨ä¼ é€’çš„callback\n  run(callback) {\n    // å½“è°ƒç”¨runæ–¹å¼æ—¶ è§¦å‘å¼€å§‹ç¼–è¯‘çš„plugin\n    this.hooks.run.call();\n    // è·å–å…¥å£é…ç½®å¯¹è±¡\n    const entry = this.getEntry();\n  }\n\n  // è·å–å…¥å£æ–‡ä»¶è·¯å¾„\n  getEntry() {\n    let entry = Object.create(null);\n    const { entry: optionsEntry } = this.options;\n    if (typeof optionsEntry === 'string') {\n      entry['main'] = optionsEntry;\n    } else {\n      entry = optionsEntry;\n    }\n    // å°†entryå˜æˆç»å¯¹è·¯å¾„\n    Object.keys(entry).forEach((key) => {\n      const value = entry[key];\n      if (!path.isAbsolute(value)) {\n        // è½¬åŒ–ä¸ºç»å¯¹è·¯å¾„çš„åŒæ—¶ç»Ÿä¸€è·¯å¾„åˆ†éš”ç¬¦ä¸º /\n        entry[key] = toUnixPath(path.join(this.rootPath, value));\n      }\n    });\n    return entry;\n  }\n}\n\nmodule.exports = Compiler;\n")])])]),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("// utils/index.js\n/**\n *\n * ç»Ÿä¸€è·¯å¾„åˆ†éš”ç¬¦ ä¸»è¦æ˜¯ä¸ºäº†åç»­ç”Ÿæˆæ¨¡å—IDæ–¹ä¾¿\n * @param {*} path\n * @returns\n */\nfunction toUnixPath(path) {\n  return path.replace(/\\\\/g, '/');\n}\n")])])]),t("p",[e._v("è¿™ä¸€æ­¥æˆ‘ä»¬é€šè¿‡options.entryå¤„ç†è·å¾—å…¥å£æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚")]),e._v(" "),t("p",[e._v("è¿™é‡Œæœ‰å‡ ä¸ªéœ€è¦æ³¨æ„çš„å°ç‚¹:")]),e._v(" "),t("ul",[t("li",[e._v("==this.hooks.run.call()==")])]),e._v(" "),t("p",[e._v("åœ¨æˆ‘ä»¬_loadePluginså‡½æ•°ä¸­å¯¹äºæ¯ä¸€ä¸ªä¼ å…¥çš„æ’ä»¶åœ¨compilerå®ä¾‹å¯¹è±¡ä¸­è¿›è¡Œäº†è®¢é˜…ï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬è°ƒç”¨runæ–¹æ³•æ—¶ï¼Œç­‰äºçœŸæ­£å¼€å§‹æ‰§è¡Œç¼–è¯‘ã€‚è¿™ä¸ªé˜¶æ®µç›¸å½“äºæˆ‘ä»¬éœ€è¦å‘Šè¯‰è®¢é˜…è€…ï¼Œå‘å¸ƒå¼€å§‹æ‰§è¡Œçš„è®¢é˜…ã€‚æ­¤æ—¶æˆ‘ä»¬é€šè¿‡this.hooks.run.call()æ‰§è¡Œå…³äºrunçš„æ‰€æœ‰tapç›‘å¬æ–¹æ³•ï¼Œä»è€Œè§¦å‘å¯¹åº”çš„pluginé€»è¾‘ã€‚")]),e._v(" "),t("ul",[t("li",[e._v("==this.rootPath:==")])]),e._v(" "),t("p",[e._v("åœ¨ä¸Šè¿°çš„å¤–éƒ¨webpack.config.jsä¸­æˆ‘ä»¬é…ç½®äº†ä¸€ä¸ª context: process.cwd()ï¼Œå…¶å®çœŸå®webpackä¸­è¿™ä¸ªcontextå€¼é»˜è®¤ä¹Ÿæ˜¯process.cwd()ã€‚")]),e._v(" "),t("p",[e._v("å…³äºå®ƒçš„è¯¦ç»†è§£é‡Šä½ å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°"),t("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fwebpack.js.org%2Fconfiguration%2Fentry-context%2F%23root",target:"_blank",rel:"noopener noreferrer"}},[e._v("Context"),t("OutboundLink")],1),e._v("ã€‚")]),e._v(" "),t("p",[e._v("ç®€è€Œè¨€ä¹‹ï¼Œè¿™ä¸ªè·¯å¾„å°±æ˜¯æˆ‘ä»¬é¡¹ç›®å¯åŠ¨çš„ç›®å½•è·¯å¾„ï¼Œä»»ä½•entryå’Œloaderä¸­çš„ç›¸å¯¹è·¯å¾„éƒ½æ˜¯é’ˆå¯¹äºcontextè¿™ä¸ªå‚æ•°çš„ç›¸å¯¹è·¯å¾„ã€‚")]),e._v(" "),t("p",[e._v("è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨this.rootPathåœ¨æ„é€ å‡½æ•°ä¸­æ¥ä¿å­˜è¿™ä¸ªå˜é‡ã€‚")]),e._v(" "),t("ul",[t("li",[e._v("toUnixPathå·¥å…·æ–¹æ³•:")])]),e._v(" "),t("p",[e._v("å› ä¸ºä¸åŒæ“ä½œç³»ç»Ÿä¸‹ï¼Œæ–‡ä»¶åˆ†éš”è·¯å¾„æ˜¯ä¸åŒçš„ã€‚è¿™é‡Œæˆ‘ä»¬ç»Ÿä¸€ä½¿ç”¨\\æ¥æ›¿æ¢è·¯å¾„ä¸­çš„//æ¥æ›¿æ¢æ¨¡å—è·¯å¾„ã€‚åç»­æˆ‘ä»¬ä¼šä½¿ç”¨æ¨¡å—ç›¸å¯¹äºrootPathçš„è·¯å¾„ä½œä¸ºæ¯ä¸€ä¸ªæ–‡ä»¶çš„å”¯ä¸€IDï¼Œæ‰€ä»¥è¿™é‡Œç»Ÿä¸€å¤„ç†ä¸‹è·¯å¾„åˆ†éš”ç¬¦ã€‚")]),e._v(" "),t("ul",[t("li",[e._v("entryçš„å¤„ç†æ–¹æ³•:")])]),e._v(" "),t("p",[e._v("å…³äºentryé…ç½®ï¼Œwebpackä¸­å…¶å®æœ‰å¾ˆå¤šç§ã€‚æˆ‘ä»¬è¿™é‡Œè€ƒè™‘äº†æ¯”è¾ƒå¸¸è§çš„ä¸¤ç§é…ç½®æ–¹å¼:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("entry:'entry1.js'\n\n// æœ¬è´¨ä¸Šè¿™æ®µä»£ç åœ¨webpackä¸­ä¼šè¢«è½¬åŒ–ä¸º\nentry: {\n    main:'entry1.js\n}\n")])])]),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("entry: {\n   'entry1':'./entry1.js',\n   'entry2':'/user/wepback/example/src/entry2.js'\n}\n")])])]),t("p",[e._v("è¿™ä¸¤ç§æ–¹å¼ä»»ä½•æ–¹å¼éƒ½ä¼šç»è¿‡==getEntry==æ–¹æ³•æœ€ç»ˆè½¬åŒ–ç§°ä¸º{ [æ¨¡å—å]:[æ¨¡å—ç»å¯¹è·¯å¾„]... }çš„å½¢å¼ï¼Œå…³äºgeEntry()æ–¹æ³•å…¶å®éå¸¸ç®€å•ï¼Œè¿™é‡Œæˆ‘å°±ä¸è¿‡äºç´¯èµ˜è¿™ä¸ªæ–¹æ³•çš„å®ç°è¿‡ç¨‹äº†ã€‚")]),e._v(" "),t("p",[e._v("è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬å°±é€šè¿‡==getEntry==æ–¹æ³•è·å¾—äº†ä¸€ä¸ª==key==ä¸º==entryName,valueä¸ºentryAbsolutePath==çš„å¯¹è±¡äº†ï¼Œæ¥æ¥ä¸‹å°±è®©æˆ‘ä»¬ä»å…¥å£æ–‡ä»¶å‡ºå‘è¿›è¡Œç¼–è¯‘æµç¨‹å§ã€‚")]),e._v(" "),t("h2",{attrs:{id:"æ¨¡å—ç¼–è¯‘é˜¶æ®µ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ¨¡å—ç¼–è¯‘é˜¶æ®µ"}},[e._v("#")]),e._v(" æ¨¡å—ç¼–è¯‘é˜¶æ®µ")]),e._v(" "),t("p",[e._v("ä¸Šè¾¹æˆ‘ä»¬è®²è¿°äº†å…³äºç¼–è¯‘é˜¶æ®µçš„å‡†å¤‡å·¥ä½œ:")]),e._v(" "),t("ul",[t("li",[e._v("ç›®å½•/æ–‡ä»¶åŸºç¡€é€»è¾‘è¡¥å……ã€‚")]),e._v(" "),t("li",[e._v("é€šè¿‡hooks.tapæ³¨å†Œwebpackæ’ä»¶ã€‚")]),e._v(" "),t("li",[e._v("getEntryæ–¹æ³•è·å¾—å„ä¸ªå…¥å£çš„å¯¹è±¡ã€‚")])]),e._v(" "),t("p",[e._v("æ¥ä¸‹æ¥è®©æˆ‘ä»¬ç»§ç»­å®Œå–„compiler.jsã€‚")]),e._v(" "),t("p",[e._v("åœ¨æ¨¡å—ç¼–è¯‘é˜¶æ®µï¼Œæˆ‘ä»¬éœ€è¦åšçš„äº‹ä»¶:")]),e._v(" "),t("ul",[t("li",[e._v("æ ¹æ®å…¥å£æ–‡ä»¶è·¯å¾„åˆ†æå…¥å£æ–‡ä»¶ï¼Œå¯¹äºå…¥å£æ–‡ä»¶è¿›è¡ŒåŒ¹é…å¯¹åº”çš„loaderè¿›è¡Œå¤„ç†å…¥å£æ–‡ä»¶ã€‚")]),e._v(" "),t("li",[e._v("å°†loaderå¤„ç†å®Œæˆçš„å…¥å£æ–‡ä»¶ä½¿ç”¨webpackè¿›è¡Œç¼–è¯‘ã€‚")]),e._v(" "),t("li",[e._v("åˆ†æå…¥å£æ–‡ä»¶ä¾èµ–ï¼Œé‡å¤ä¸Šè¾¹ä¸¤ä¸ªæ­¥éª¤ç¼–è¯‘å¯¹åº”ä¾èµ–ã€‚")]),e._v(" "),t("li",[e._v("å¦‚æœåµŒå¥—æ–‡ä»¶å­˜åœ¨ä¾èµ–æ–‡ä»¶ï¼Œé€’å½’è°ƒç”¨ä¾èµ–æ¨¡å—è¿›è¡Œç¼–è¯‘ã€‚")]),e._v(" "),t("li",[e._v("é€’å½’ç¼–è¯‘å®Œæˆåï¼Œç»„è£…ä¸€ä¸ªä¸ªåŒ…å«å¤šä¸ªæ¨¡å—çš„chunk")])]),e._v(" "),t("p",[e._v("é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆæ¥ç»™compiler.jsçš„æ„é€ å‡½æ•°ä¸­è¡¥å……ä¸€ä¸‹å¯¹åº”çš„é€»è¾‘:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("class Compiler {\n  constructor(options) {\n    this.options = options;\n    // åˆ›å»ºplugin hooks\n    this.hooks = {\n      // å¼€å§‹ç¼–è¯‘æ—¶çš„é’©å­\n      run: new SyncHook(),\n      // è¾“å‡º asset åˆ° output ç›®å½•ä¹‹å‰æ‰§è¡Œ (å†™å…¥æ–‡ä»¶ä¹‹å‰)\n      emit: new SyncHook(),\n      // åœ¨ compilation å®Œæˆæ—¶æ‰§è¡Œ å…¨éƒ¨å®Œæˆç¼–è¯‘æ‰§è¡Œ\n      done: new SyncHook(),\n    };\n    // ä¿å­˜æ‰€æœ‰å…¥å£æ¨¡å—å¯¹è±¡\n    this.entries = new Set();\n    // ä¿å­˜æ‰€æœ‰ä¾èµ–æ¨¡å—å¯¹è±¡\n    this.modules = new Set();\n    // æ‰€æœ‰çš„ä»£ç å—å¯¹è±¡\n    this.chunks = new Set();\n    // å­˜æ”¾æœ¬æ¬¡äº§å‡ºçš„æ–‡ä»¶å¯¹è±¡\n    this.assets = new Set();\n    // å­˜æ”¾æœ¬æ¬¡ç¼–è¯‘æ‰€æœ‰äº§å‡ºçš„æ–‡ä»¶å\n    this.files = new Set();\n  }\n  // ...\n }\n")])])]),t("p",[e._v("è¿™é‡Œæˆ‘ä»¬é€šè¿‡ç»™==compiler==æ„é€ å‡½æ•°ä¸­æ·»åŠ ä¸€äº›åˆ—å±æ€§æ¥ä¿å­˜å…³äºç¼–è¯‘é˜¶æ®µç”Ÿæˆçš„å¯¹åº”èµ„æº/æ¨¡å—å¯¹è±¡ã€‚")]),e._v(" "),t("blockquote",[t("p",[e._v("å…³äºentries\\modules\\chunks\\assets\\filesè¿™å‡ ä¸ªSetå¯¹è±¡æ˜¯è´¯ç©¿æˆ‘ä»¬æ ¸å¿ƒæ‰“åŒ…æµç¨‹çš„å±æ€§ï¼Œå®ƒä»¬å„è‡ªç”¨æ¥å‚¨å­˜ç¼–è¯‘é˜¶æ®µä¸åŒçš„èµ„æºä»è€Œæœ€ç»ˆé€šè¿‡å¯¹åº”çš„å±æ€§è¿›è¡Œç”Ÿæˆç¼–è¯‘åçš„æ–‡ä»¶ã€‚")])]),e._v(" "),t("h3",{attrs:{id:"æ ¹æ®å…¥å£æ–‡ä»¶è·¯å¾„åˆ†æå…¥å£æ–‡ä»¶"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ ¹æ®å…¥å£æ–‡ä»¶è·¯å¾„åˆ†æå…¥å£æ–‡ä»¶"}},[e._v("#")]),e._v(" æ ¹æ®å…¥å£æ–‡ä»¶è·¯å¾„åˆ†æå…¥å£æ–‡ä»¶")]),e._v(" "),t("p",[e._v("ä¸Šè¾¹è¯´åˆ°æˆ‘ä»¬åœ¨runæ–¹æ³•ä¸­å·²ç»å¯ä»¥é€šè¿‡this.getEntry();è·å¾—å¯¹åº”çš„å…¥å£å¯¹è±¡äº†ï½\næ¥ä¸‹æ¥å°±è®©æˆ‘ä»¬ä»å…¥å£æ–‡ä»¶å¼€å§‹å»åˆ†æå…¥å£æ–‡ä»¶å§ï¼")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("class Compiler {\n    // runæ–¹æ³•å¯åŠ¨ç¼–è¯‘\n  // åŒæ—¶runæ–¹æ³•æ¥å—å¤–éƒ¨ä¼ é€’çš„callback\n  run(callback) {\n    // å½“è°ƒç”¨runæ–¹å¼æ—¶ è§¦å‘å¼€å§‹ç¼–è¯‘çš„plugin\n    this.hooks.run.call();\n    // è·å–å…¥å£é…ç½®å¯¹è±¡\n    const entry = this.getEntry();\n    // ç¼–è¯‘å…¥å£æ–‡ä»¶\n    this.buildEntryModule(entry);\n  }\n\n  buildEntryModule(entry) {\n    Object.keys(entry).forEach((entryName) => {\n      const entryPath = entry[entryName];\n      const entryObj = this.buildModule(entryName, entryPath);\n      this.entries.add(entryObj);\n    });\n  }\n  \n  \n  // æ¨¡å—ç¼–è¯‘æ–¹æ³•\n  buildModule(moduleName,modulePath) {\n    // ...\n    return {}\n  }\n}\n")])])]),t("p",[e._v("è¿™é‡Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªåä¸ºbuildEntryModuleæ–¹æ³•ä½œä¸ºå…¥å£æ¨¡å—ç¼–è¯‘æ–¹æ³•ã€‚å¾ªç¯å…¥å£å¯¹è±¡ï¼Œå¾—åˆ°æ¯ä¸€ä¸ªå…¥å£å¯¹è±¡çš„åç§°å’Œè·¯å¾„ã€‚")]),e._v(" "),t("blockquote",[t("p",[e._v("æ¯”å¦‚å‡ä½¿æˆ‘ä»¬åœ¨å¼€å¤´ä¼ å…¥entry:{ main:'./src/main.js' }çš„è¯ï¼ŒbuildEntryModuleè·å¾—çš„å½¢å‚entryä¸º{ main: \"/src...[ä½ çš„ç»å¯¹è·¯å¾„]\" }, æ­¤æ—¶æˆ‘ä»¬buildModuleæ–¹æ³•æ¥å—çš„entryNameä¸ºmain,entryPathä¸ºå…¥å£æ–‡ä»¶mainå¯¹åº”çš„çš„ç»å¯¹è·¯å¾„ã€‚")])]),e._v(" "),t("blockquote",[t("p",[e._v("å•ä¸ªå…¥å£ç¼–è¯‘å®Œæˆåï¼Œæˆ‘ä»¬ä¼šåœ¨buildModuleæ–¹æ³•ä¸­è¿”å›ä¸€ä¸ªå¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡å°±æ˜¯æˆ‘ä»¬ç¼–è¯‘å…¥å£æ–‡ä»¶åçš„å¯¹è±¡ã€‚")])]),e._v(" "),t("h3",{attrs:{id:"buildmoduleæ¨¡å—ç¼–è¯‘æ–¹æ³•"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#buildmoduleæ¨¡å—ç¼–è¯‘æ–¹æ³•"}},[e._v("#")]),e._v(" buildModuleæ¨¡å—ç¼–è¯‘æ–¹æ³•")]),e._v(" "),t("p",[e._v("åœ¨è¿›è¡Œä»£ç ç¼–å†™ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥æ¢³ç†ä¸€ä¸‹buildModuleæ–¹æ³•å®ƒéœ€è¦åšå“ªäº›äº‹æƒ…:")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("buildModuleæ¥å—ä¸¤ä¸ªå‚æ•°è¿›è¡Œæ¨¡å—ç¼–è¯‘ï¼Œ"),t("strong",[e._v("ç¬¬ä¸€ä¸ªä¸ºæ¨¡å—æ‰€å±çš„å…¥å£æ–‡ä»¶åç§°")]),e._v("ï¼Œç¬¬äºŒä¸ªä¸ºéœ€è¦ç¼–è¯‘çš„æ¨¡å—è·¯å¾„ã€‚")])]),e._v(" "),t("li",[t("p",[e._v("buildModuleæ–¹æ³•è¦è¿›è¡Œä»£ç ç¼–è¯‘çš„å‰æå°±æ˜¯ï¼Œé€šè¿‡fsæ¨¡å—æ ¹æ®å…¥å£æ–‡ä»¶è·¯å¾„è¯»å–æ–‡ä»¶æºä»£ç ã€‚")])]),e._v(" "),t("li",[t("p",[e._v("è¯»å–æ–‡ä»¶å†…å®¹ä¹‹åï¼Œè°ƒç”¨æ‰€æœ‰åŒ¹é…çš„loaderå¯¹æ¨¡å—è¿›è¡Œå¤„ç†å¾—åˆ°è¿”å›åçš„ç»“æœã€‚")])]),e._v(" "),t("li",[t("p",[e._v("å¾—åˆ°loaderå¤„ç†åçš„ç»“æœåï¼Œé€šè¿‡babelåˆ†æloaderå¤„ç†åçš„ä»£ç ï¼Œè¿›è¡Œä»£ç ç¼–è¯‘ã€‚(è¿™ä¸€æ­¥ç¼–è¯‘ä¸»è¦æ˜¯é’ˆå¯¹requireè¯­å¥ï¼Œä¿®æ”¹æºä»£ç ä¸­requireè¯­å¥çš„è·¯å¾„)ã€‚")])]),e._v(" "),t("li",[t("p",[e._v("å¦‚æœè¯¥å…¥å£æ–‡ä»¶æ²¡æœ‰ä¾èµ–ä¸ä»»ä½•æ¨¡å—(requireè¯­å¥)ï¼Œé‚£ä¹ˆè¿”å›ç¼–è¯‘åçš„æ¨¡å—å¯¹è±¡ã€‚")])]),e._v(" "),t("li",[t("p",[e._v("å¦‚æœè¯¥å…¥å£æ–‡ä»¶å­˜åœ¨ä¾èµ–çš„æ¨¡å—ï¼Œé€’å½’buildModuleæ–¹æ³•è¿›è¡Œæ¨¡å—ç¼–è¯‘ã€‚")])])]),e._v(" "),t("h4",{attrs:{id:"è¯»å–æ–‡ä»¶å†…å®¹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#è¯»å–æ–‡ä»¶å†…å®¹"}},[e._v("#")]),e._v(" è¯»å–æ–‡ä»¶å†…å®¹")]),e._v(" "),t("ol",[t("li",[e._v("æˆ‘ä»¬å…ˆè°ƒç”¨fsæ¨¡å—è¯»å–æ–‡ä»¶å†…å®¹ã€‚")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("const fs = require('fs');\n// ...\nclass Compiler {\n      //...\n      // æ¨¡å—ç¼–è¯‘æ–¹æ³•\n      buildModule(moduleName, modulePath) {\n        // 1. è¯»å–æ–‡ä»¶åŸå§‹ä»£ç \n        const originSourceCode =\n          ((this.originSourceCode = fs.readFileSync(modulePath, 'utf-8'));\n        // moduleCodeä¸ºä¿®æ”¹åçš„ä»£ç \n        this.moduleCode = originSourceCode;\n      }\n      \n      // ...\n }\n")])])]),t("h4",{attrs:{id:"è°ƒç”¨loaderå¤„ç†åŒ¹é…åç¼€æ–‡ä»¶"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#è°ƒç”¨loaderå¤„ç†åŒ¹é…åç¼€æ–‡ä»¶"}},[e._v("#")]),e._v(" è°ƒç”¨loaderå¤„ç†åŒ¹é…åç¼€æ–‡ä»¶")]),e._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[e._v("æ¥ä¸‹æ¥æˆ‘ä»¬è·å¾—äº†æ–‡ä»¶çš„å…·ä½“å†…å®¹ä¹‹åï¼Œå°±éœ€è¦åŒ¹é…å¯¹åº”loaderå¯¹æˆ‘ä»¬çš„æºä»£ç è¿›è¡Œç¼–è¯‘äº†ã€‚")])]),e._v(" "),t("p",[e._v("=="),t("strong",[e._v("å®ç°ç®€å•è‡ªå®šä¹‰loader")]),e._v("==\nåœ¨è¿›è¡Œloaderç¼–è¯‘å‰ï¼Œæˆ‘ä»¬å…ˆæ¥å®ç°ä¸€ä¸‹æˆ‘ä»¬ä¸Šæ–¹ä¼ å…¥çš„è‡ªå®šä¹‰loaderå§ã€‚\n"),t("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c08cd30dbb0b459f8441cf8b50c0bc84~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?",alt:"image"}})]),e._v(" "),t("p",[e._v("webpack/loaderç›®å½•ä¸‹æ–°å»ºloader-1.js,loader-2.js:\né¦–å…ˆæˆ‘ä»¬éœ€è¦æ¸…æ¥šç®€å•æ¥è¯´==loaderæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ¥å—æˆ‘ä»¬çš„æºä»£ç ä½œä¸ºå…¥å‚åŒæ—¶è¿”å›å¤„ç†åçš„ç»“æœ==ã€‚")]),e._v(" "),t("blockquote",[t("p",[e._v("å…³äºloaderçš„ç‰¹æ€§ï¼Œæ›´åŠ è¯¦ç»†ä½ å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°ï¼Œå› ä¸ºæ–‡ç« ä¸»è¦è®²è¿°æ‰“åŒ…æµç¨‹æ‰€ä»¥loaderæˆ‘ä»¬ç®€å•çš„ä½œä¸ºå€’åºå¤„ç†ã€‚æ›´åŠ å…·ä½“çš„loader/pluginå¼€å‘æˆ‘ä¼šåœ¨åç»­çš„æ–‡ç« è¯¦ç»†è¡¥å……ã€‚")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("// loaderæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ¥å—åŸå§‹å†…å®¹ï¼Œè¿”å›è½¬æ¢åçš„å†…å®¹ã€‚\nfunction loader1(sourceCode) {\n  console.log('join loader1');\n  return sourceCode + `\\n const loader1 = 'https://github.com/19Qingfeng'`;\n}\n\nmodule.exports = loader1;\nå¤åˆ¶ä»£ç \nfunction loader2(sourceCode) {\n  console.log('join loader2');\n  return sourceCode + `\\n const loader2 = '19Qingfeng'`;\n}\n\nmodule.exports = loader2;\n")])])]),t("p",[e._v("=="),t("strong",[e._v("ä½¿ç”¨loaderå¤„ç†æ–‡ä»¶")]),e._v("==\nåœ¨ææ¸…æ¥šäº†loaderå°±æ˜¯ä¸€ä¸ªå•çº¯çš„å‡½æ•°ä¹‹åï¼Œè®©æˆ‘ä»¬åœ¨è¿›è¡Œæ¨¡å—åˆ†æä¹‹å‰å°†å†…å®¹å…ˆäº¤ç»™åŒ¹é…çš„loaderå»å¤„ç†ä¸‹å§ã€‚")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("// æ¨¡å—ç¼–è¯‘æ–¹æ³•\n  buildModule(moduleName, modulePath) {\n    // 1. è¯»å–æ–‡ä»¶åŸå§‹ä»£ç \n    const originSourceCode =\n      ((this.originSourceCode = fs.readFileSync(modulePath)), 'utf-8');\n    // moduleCodeä¸ºä¿®æ”¹åçš„ä»£ç \n    this.moduleCode = originSourceCode;\n    //  2. è°ƒç”¨loaderè¿›è¡Œå¤„ç†\n    this.handleLoader(modulePath);\n  }\n\n  // åŒ¹é…loaderå¤„ç†\n  handleLoader(modulePath) {\n    const matchLoaders = [];\n    // 1. è·å–æ‰€æœ‰ä¼ å…¥çš„loaderè§„åˆ™\n    const rules = this.options.module.rules;\n    rules.forEach((loader) => {\n      const testRule = loader.test;\n      if (testRule.test(modulePath)) {\n        if (loader.loader) {\n          // ä»…è€ƒè™‘loader { test:/\\.js$/g, use:['babel-loader'] }, { test:/\\.js$/, loader:'babel-loader' }\n          matchLoaders.push(loader.loader);\n        } else {\n          matchLoaders.push(...loader.use);\n        }\n      }\n      // 2. å€’åºæ‰§è¡Œloaderä¼ å…¥æºä»£ç \n      for (let i = matchLoaders.length - 1; i >= 0; i--) {\n        // ç›®å‰æˆ‘ä»¬å¤–éƒ¨ä»…æ”¯æŒä¼ å…¥ç»å¯¹è·¯å¾„çš„loaderæ¨¡å¼\n        // requireå¼•å…¥å¯¹åº”loader\n        const loaderFn = require(matchLoaders[i]);\n        // é€šè¿‡loaderåŒæ­¥å¤„ç†æˆ‘çš„æ¯ä¸€æ¬¡ç¼–è¯‘çš„moduleCode\n        this.moduleCode = loaderFn(this.moduleCode);\n      }\n    });\n  }\n")])])]),t("p",[e._v("è¿™é‡Œæˆ‘ä»¬é€šè¿‡handleLoaderå‡½æ•°ï¼Œå¯¹äºä¼ å…¥çš„æ–‡ä»¶è·¯å¾„åŒ¹é…åˆ°å¯¹åº”åç¼€çš„loaderåï¼Œä¾æ¬¡å€’åºæ‰§è¡Œloaderå¤„ç†æˆ‘ä»¬çš„ä»£ç this.moduleCodeå¹¶ä¸”åŒæ­¥æ›´æ–°æ¯æ¬¡moduleCodeã€‚")]),e._v(" "),t("p",[e._v("æœ€ç»ˆï¼Œåœ¨æ¯ä¸€ä¸ªæ¨¡å—ç¼–è¯‘ä¸­this.moduleCodeéƒ½ä¼šç»è¿‡å¯¹åº”çš„loaderå¤„ç†ã€‚")]),e._v(" "),t("h4",{attrs:{id:"webpackæ¨¡å—ç¼–è¯‘é˜¶æ®µ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#webpackæ¨¡å—ç¼–è¯‘é˜¶æ®µ"}},[e._v("#")]),e._v(" webpackæ¨¡å—ç¼–è¯‘é˜¶æ®µ")]),e._v(" "),t("p",[e._v("ä¸Šä¸€æ­¥æˆ‘ä»¬ç»å†è¿‡loaderå¤„ç†äº†æˆ‘ä»¬çš„å…¥å£æ–‡ä»¶ä»£ç ï¼Œå¹¶ä¸”å¾—åˆ°äº†å¤„ç†åçš„ä»£ç ä¿å­˜åœ¨äº†this.moduleCodeä¸­ã€‚")]),e._v(" "),t("p",[e._v("æ­¤æ—¶ï¼Œç»è¿‡loaderå¤„ç†åæˆ‘ä»¬å°±è¦è¿›å…¥webpackå†…éƒ¨çš„ç¼–è¯‘é˜¶æ®µäº†ã€‚")]),e._v(" "),t("p",[e._v("è¿™é‡Œæˆ‘ä»¬éœ€è¦åšçš„æ˜¯:"),t("strong",[e._v("é’ˆå¯¹å½“å‰æ¨¡å—è¿›è¡Œç¼–è¯‘ï¼Œå°†å½“å‰æ¨¡å—æ‰€æœ‰ä¾èµ–çš„æ¨¡å—(require())è¯­å¥å¼•å…¥çš„è·¯å¾„å˜ä¸ºç›¸å¯¹äºè·Ÿè·¯å¾„(this.rootPath)çš„ç›¸å¯¹è·¯å¾„")]),e._v("ã€‚")]),e._v(" "),t("blockquote",[t("p",[e._v("æ€»ä¹‹ä½ éœ€è¦ææ˜ç™½çš„æ˜¯ï¼Œæˆ‘ä»¬è¿™é‡Œç¼–è¯‘çš„ç»“æœæ˜¯æœŸæœ›å°†æºä»£ç ä¸­çš„ä¾èµ–æ¨¡å—è·¯å¾„å˜ä¸ºç›¸å¯¹è·Ÿè·¯å¾„çš„è·¯å¾„ï¼ŒåŒæ—¶å»ºç«‹åŸºç¡€çš„æ¨¡å—ä¾èµ–å…³ç³»ã€‚åç»­æˆ‘ä¼šå‘Šè¯‰ä½ ä¸ºä»€ä¹ˆé’ˆå¯¹è·¯å¾„è¿›è¡Œç¼–è¯‘ã€‚")])]),e._v(" "),t("p",[e._v("è®©æˆ‘ä»¬ç»§ç»­æ¥å®Œå–„buildModuleæ–¹æ³•å§:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("const parser = require('@babel/parser');\nconst traverse = require('@babel/traverse').default;\nconst generator = require('@babel/generator').default;\nconst t = require('@babel/types');\nconst tryExtensions = require('./utils/index')\n// ...\n  class Compiler {\n     // ...\n      \n     // æ¨¡å—ç¼–è¯‘æ–¹æ³•\n      buildModule(moduleName, modulePath) {\n        // 1. è¯»å–æ–‡ä»¶åŸå§‹ä»£ç \n        const originSourceCode =\n          ((this.originSourceCode = fs.readFileSync(modulePath)), 'utf-8');\n        // moduleCodeä¸ºä¿®æ”¹åçš„ä»£ç \n        this.moduleCode = originSourceCode;\n        //  2. è°ƒç”¨loaderè¿›è¡Œå¤„ç†\n        this.handleLoader(modulePath);\n        // 3. è°ƒç”¨webpack è¿›è¡Œæ¨¡å—ç¼–è¯‘ è·å¾—æœ€ç»ˆçš„moduleå¯¹è±¡\n        const module = this.handleWebpackCompiler(moduleName, modulePath);\n        // 4. è¿”å›å¯¹åº”module\n        return module\n      }\n\n      // è°ƒç”¨webpackè¿›è¡Œæ¨¡å—ç¼–è¯‘\n      handleWebpackCompiler(moduleName, modulePath) {\n        // å°†å½“å‰æ¨¡å—ç›¸å¯¹äºé¡¹ç›®å¯åŠ¨æ ¹ç›®å½•è®¡ç®—å‡ºç›¸å¯¹è·¯å¾„ ä½œä¸ºæ¨¡å—ID\n        const moduleId = './' + path.posix.relative(this.rootPath, modulePath);\n        // åˆ›å»ºæ¨¡å—å¯¹è±¡\n        const module = {\n          id: moduleId,\n          dependencies: new Set(), // è¯¥æ¨¡å—æ‰€ä¾èµ–æ¨¡å—ç»å¯¹è·¯å¾„åœ°å€\n          name: [moduleName], // è¯¥æ¨¡å—æ‰€å±çš„å…¥å£æ–‡ä»¶\n        };\n        // è°ƒç”¨babelåˆ†ææˆ‘ä»¬çš„ä»£ç \n        const ast = parser.parse(this.moduleCode, {\n          sourceType: 'module',\n        });\n        // æ·±åº¦ä¼˜å…ˆ éå†è¯­æ³•Tree\n        traverse(ast, {\n          // å½“é‡åˆ°requireè¯­å¥æ—¶\n          CallExpression:(nodePath) => {\n            const node = nodePath.node;\n            if (node.callee.name === 'require') {\n              // è·å¾—æºä»£ç ä¸­å¼•å…¥æ¨¡å—ç›¸å¯¹è·¯å¾„\n              const requirePath = node.arguments[0].value;\n              // å¯»æ‰¾æ¨¡å—ç»å¯¹è·¯å¾„ å½“å‰æ¨¡å—è·¯å¾„+require()å¯¹åº”ç›¸å¯¹è·¯å¾„\n              const moduleDirName = path.posix.dirname(modulePath);\n              const absolutePath = tryExtensions(\n                path.posix.join(moduleDirName, requirePath),\n                this.options.resolve.extensions,\n                requirePath,\n                moduleDirName\n              );\n              // ç”ŸæˆmoduleId - é’ˆå¯¹äºè·Ÿè·¯å¾„çš„æ¨¡å—ID æ·»åŠ è¿›å…¥æ–°çš„ä¾èµ–æ¨¡å—è·¯å¾„\n              const moduleId =\n                './' + path.posix.relative(this.rootPath, absolutePath);\n              // é€šè¿‡babelä¿®æ”¹æºä»£ç ä¸­çš„requireå˜æˆ__webpack_require__è¯­å¥\n              node.callee = t.identifier('__webpack_require__');\n              // ä¿®æ”¹æºä»£ç ä¸­requireè¯­å¥å¼•å…¥çš„æ¨¡å— å…¨éƒ¨ä¿®æ”¹å˜ä¸ºç›¸å¯¹äºè·Ÿè·¯å¾„æ¥å¤„ç†\n              node.arguments = [t.stringLiteral(moduleId)];\n              // ä¸ºå½“å‰æ¨¡å—æ·»åŠ requireè¯­å¥é€ æˆçš„ä¾èµ–(å†…å®¹ä¸ºç›¸å¯¹äºæ ¹è·¯å¾„çš„æ¨¡å—ID)\n              module.dependencies.add(moduleId);\n            }\n          },\n        });\n        // éå†ç»“æŸæ ¹æ®ASTç”Ÿæˆæ–°çš„ä»£ç \n        const { code } = generator(ast);\n        // ä¸ºå½“å‰æ¨¡å—æŒ‚è½½æ–°çš„ç”Ÿæˆçš„ä»£ç \n        module._source = code;\n        // è¿”å›å½“å‰æ¨¡å—å¯¹è±¡\n        return module\n      }\n  }\n")])])]),t("p",[e._v("è¿™ä¸€æ­¥æˆ‘ä»¬å…³äºwebpackç¼–è¯‘çš„é˜¶æ®µå°±å®Œæˆäº†ã€‚")]),e._v(" "),t("p",[t("strong",[e._v("éœ€è¦æ³¨æ„çš„æ˜¯")]),e._v(":")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨babelç›¸å…³çš„APIé’ˆå¯¹äºrequireè¯­å¥è¿›è¡Œäº†ç¼–è¯‘ï¼Œå¦‚æœå¯¹äºbabelç›¸å…³çš„apiä¸å¤ªäº†è§£çš„æœ‹å‹å¯ä»¥åœ¨å‰ç½®çŸ¥è¯†ä¸­æŸ¥çœ‹æˆ‘çš„å¦ä¸¤ç¯‡æ–‡ç« ã€‚è¿™é‡Œæˆ‘å°±ä¸åœ¨ç´¯èµ˜äº†")])]),e._v(" "),t("li",[t("p",[e._v("åŒæ—¶æˆ‘ä»¬ä»£ç ä¸­å¼•ç”¨äº†ä¸€ä¸ªtryExtensions()å·¥å…·æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯é’ˆå¯¹äºåç¼€åä¸å…¨çš„å·¥å…·æ–¹æ³•ï¼Œç¨åä½ å°±å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ–¹æ³•çš„å…·ä½“å†…å®¹ã€‚")])]),e._v(" "),t("li",[t("p",[e._v("é’ˆå¯¹äºæ¯ä¸€æ¬¡æ–‡ä»¶ç¼–è¯‘ï¼Œæˆ‘ä»¬éƒ½ä¼šè¿”å›ä¸€ä¸ªmoduleå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ˜¯é‡ä¸­ä¹‹é‡ã€‚")]),e._v(" "),t("ul",[t("li",[e._v("idå±æ€§ï¼Œè¡¨ç¤ºå½“å‰æ¨¡å—é’ˆå¯¹äºthis.rootPathçš„ç›¸å¯¹ç›®å½•ã€‚")]),e._v(" "),t("li",[e._v("dependencieså±æ€§ï¼Œå®ƒæ˜¯ä¸€ä¸ªSetå†…éƒ¨ä¿å­˜äº†è¯¥æ¨¡å—ä¾èµ–çš„æ‰€æœ‰æ¨¡å—çš„æ¨¡å—IDã€‚")]),e._v(" "),t("li",[e._v("nameå±æ€§,å®ƒè¡¨ç¤ºè¯¥æ¨¡å—å±äºå“ªä¸ªå…¥å£æ–‡ä»¶ã€‚")]),e._v(" "),t("li",[e._v("_sourceå±æ€§ï¼Œå®ƒå­˜æ”¾æ¨¡å—è‡ªèº«ç»è¿‡babelç¼–è¯‘åçš„å­—ç¬¦ä¸²ä»£ç ã€‚")])])])]),e._v(" "),t("p",[e._v("=="),t("strong",[e._v("tryExtensionsæ–¹æ³•å®ç°")]),e._v("==\næˆ‘ä»¬åœ¨ä¸Šæ–‡çš„webpack.config.jsæœ‰è¿™ä¹ˆä¸€ä¸ªé…ç½®ï¼š\n"),t("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5d49f431c11e4d83a6ab46f54fefd6b5~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?",alt:"image"}})]),e._v(" "),t("p",[e._v("ç†Ÿæ‚‰webpacké…ç½®çš„åŒå­¦å¯èƒ½æ¸…æ¥šï¼Œresolve.extensionsæ˜¯é’ˆå¯¹äºå¼•å…¥ä¾èµ–æ—¶ï¼Œåœ¨æ²¡æœ‰ä¹¦å†™æ–‡ä»¶åç¼€çš„æƒ…å†µä¸‹ï¼Œwebpackä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬æŒ‰ç…§ä¼ å…¥çš„è§„åˆ™ä¸ºæ–‡ä»¶æ·»åŠ åç¼€ã€‚")]),e._v(" "),t("p",[e._v("åœ¨æ¸…æ¥šäº†åŸç†åæˆ‘ä»¬æ¥ä¸€èµ·çœ‹çœ‹utils/tryExtensionsæ–¹æ³•çš„å®ç°:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("/**\n *\n *\n * @param {*} modulePath æ¨¡å—ç»å¯¹è·¯å¾„\n * @param {*} extensions æ‰©å±•åæ•°ç»„\n * @param {*} originModulePath åŸå§‹å¼•å…¥æ¨¡å—è·¯å¾„\n * @param {*} moduleContext æ¨¡å—ä¸Šä¸‹æ–‡(å½“å‰æ¨¡å—æ‰€åœ¨ç›®å½•)\n */\nfunction tryExtensions(\n  modulePath,\n  extensions,\n  originModulePath,\n  moduleContext\n) {\n  // ä¼˜å…ˆå°è¯•ä¸éœ€è¦æ‰©å±•åé€‰é¡¹\n  extensions.unshift('');\n  for (let extension of extensions) {\n    if (fs.existsSync(modulePath + extension)) {\n      return modulePath + extension;\n    }\n  }\n  // æœªåŒ¹é…å¯¹åº”æ–‡ä»¶\n  throw new Error(\n    `No module, Error: Can't resolve ${originModulePath} in  ${moduleContext}`\n  );\n}\n")])])]),t("p",[e._v("è¿™ä¸ªæ–¹æ³•å¾ˆç®€å•ï¼Œæˆ‘ä»¬é€šè¿‡fs.existsSyncæ£€æŸ¥ä¼ å…¥æ–‡ä»¶ç»“åˆextensionsä¾æ¬¡éå†å¯»æ‰¾å¯¹åº”åŒ¹é…çš„è·¯å¾„æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœæ‰¾åˆ°åˆ™ç›´æ¥è¿”å›ã€‚å¦‚æœæœªæ‰¾åˆ°åˆ™ç»™äºˆç”¨äºä¸€ä¸ªå‹å¥½çš„æç¤ºé”™è¯¯ã€‚")]),e._v(" "),t("blockquote",[t("p",[e._v("éœ€è¦æ³¨æ„ extensions.unshift('');æ˜¯é˜²æ­¢ç”¨æˆ·å¦‚æœå·²ç»ä¼ å…¥äº†åç¼€æ—¶ï¼Œæˆ‘ä»¬ä¼˜å…ˆå°è¯•ç›´æ¥å¯»æ‰¾ï¼Œå¦‚æœå¯ä»¥æ‰¾åˆ°æ–‡ä»¶é‚£ä¹ˆå°±ç›´æ¥è¿”å›ã€‚æ‰¾ä¸åˆ°çš„æƒ…å†µä¸‹æ‰ä¼šä¾æ¬¡å°è¯•ã€‚")])]),e._v(" "),t("h4",{attrs:{id:"é€’å½’å¤„ç†"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#é€’å½’å¤„ç†"}},[e._v("#")]),e._v(" é€’å½’å¤„ç†")]),e._v(" "),t("p",[e._v("ç»è¿‡ä¸Šä¸€æ­¥å¤„ç†ï¼Œé’ˆå¯¹å…¥å£æ–‡ä»¶æˆ‘ä»¬è°ƒç”¨buildModuleå¯ä»¥å¾—åˆ°è¿™æ ·çš„è¿”å›å¯¹è±¡ã€‚\næˆ‘ä»¬å…ˆæ¥çœ‹çœ‹è¿è¡Œwebpack/core/index.jså¾—åˆ°çš„è¿”å›ç»“æœå§ã€‚\n"),t("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6310bca0e92e4171a571e3bdf9ce727d~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?",alt:"image"}})]),e._v(" "),t("p",[e._v("æˆ‘åœ¨buildEntryModuleä¸­æ‰“å°äº†å¤„ç†å®Œæˆåçš„entrieså¯¹è±¡ã€‚å¯ä»¥çœ‹åˆ°æ­£å¦‚æˆ‘ä»¬ä¹‹å‰æ‰€æœŸå¾…çš„:")]),e._v(" "),t("ul",[t("li",[e._v("idä¸ºæ¯ä¸ªæ¨¡å—ç›¸å¯¹äºè·Ÿè·¯å¾„çš„æ¨¡å—.(è¿™é‡Œæˆ‘ä»¬é…ç½®çš„context:process.cwd())ä¸ºwebpackç›®å½•ã€‚")]),e._v(" "),t("li",[e._v("dependenciesä¸ºè¯¥æ¨¡å—å†…éƒ¨ä¾èµ–çš„æ¨¡å—ï¼Œè¿™é‡Œç›®å‰è¿˜æ²¡æœ‰æ·»åŠ ã€‚")]),e._v(" "),t("li",[e._v("nameä¸ºè¯¥æ¨¡å—æ‰€å±çš„å…¥å£æ–‡ä»¶åç§°ã€‚")]),e._v(" "),t("li",[e._v("_sourceä¸ºè¯¥æ¨¡å—ç¼–è¯‘åçš„æºä»£ç ã€‚")])]),e._v(" "),t("blockquote",[t("p",[e._v("ç›®å‰_sourceä¸­çš„å†…å®¹æ˜¯åŸºäº")])]),e._v(" "),t("p",[e._v("æ­¤æ—¶è®©æˆ‘ä»¬æ‰“å¼€srcç›®å½•ä¸ºæˆ‘ä»¬çš„ä¸¤ä¸ªå…¥å£æ–‡ä»¶æ·»åŠ ä¸€äº›ä¾èµ–å’Œå†…å®¹å§:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("// webpack/example/entry1.js\nconst depModule = require('./module');\n\nconsole.log(depModule, 'dep');\nconsole.log('This is entry 1 !');\n\n\n// webpack/example/entry2.js\nconst depModule = require('./module');\n\nconsole.log(depModule, 'dep');\nconsole.log('This is entry 2 !');\n\n// webpack/example/module.js\nconst name = '19Qingfeng';\n\nmodule.exports = {\n  name,\n};\n")])])]),t("p",[e._v("æ­¤æ—¶è®©æˆ‘ä»¬é‡æ–°è¿è¡Œwebpack/core/index.js:\n"),t("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/00e33c57d8d243c68d6bddfc64fbea37~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?",alt:"image"}})]),e._v(" "),t("p",[e._v("OKï¼Œç›®å‰ä¸ºæ­¢æˆ‘ä»¬é’ˆå¯¹äºentryçš„ç¼–è¯‘å¯ä»¥æš‚æ—¶å‘Šä¸€æ®µè½äº†ã€‚")]),e._v(" "),t("p",[t("strong",[e._v("æ€»ä¹‹ä¹Ÿå°±æ˜¯ï¼Œè¿™ä¸€æ­¥æˆ‘ä»¬é€šè¿‡``æ–¹æ³•å°†entryè¿›è¡Œåˆ†æç¼–è¯‘åå¾—åˆ°ä¸€ä¸ªå¯¹è±¡ã€‚å°†è¿™ä¸ªå¯¹è±¡æ·»åŠ åˆ°this.entriesä¸­å»")]),e._v("ã€‚")]),e._v(" "),t("p",[e._v("æ¥ä¸‹æ¥è®©æˆ‘ä»¬å»å¤„ç†ä¾èµ–çš„æ¨¡å—å§ã€‚")]),e._v(" "),t("p",[e._v("å…¶å®å¯¹äºä¾èµ–çš„æ¨¡å—æ— éä¹Ÿæ˜¯ç›¸åŒçš„æ­¥éª¤ï¼š")]),e._v(" "),t("ul",[t("li",[e._v("æ£€æŸ¥å…¥å£æ–‡ä»¶ä¸­æ˜¯å¦å­˜åœ¨ä¾èµ–ã€‚")]),e._v(" "),t("li",[e._v("å­˜åœ¨ä¾èµ–çš„è¯ï¼Œé€’å½’è°ƒç”¨buildModuleæ–¹æ³•ç¼–è¯‘æ¨¡å—ã€‚ä¼ å…¥moduleNameä¸ºå½“å‰æ¨¡å—æ‰€å±çš„å…¥å£æ–‡ä»¶ã€‚modulePathä¸ºå½“å‰è¢«ä¾èµ–æ¨¡å—çš„ç»å¯¹è·¯å¾„ã€‚")]),e._v(" "),t("li",[e._v("åŒç†æ£€æŸ¥é€’å½’æ£€æŸ¥è¢«ä¾èµ–çš„æ¨¡å—å†…éƒ¨æ˜¯å¦ä»ç„¶å­˜åœ¨ä¾èµ–ï¼Œå­˜åœ¨çš„è¯é€’å½’ä¾èµ–è¿›è¡Œæ¨¡å—ç¼–è¯‘ã€‚è¿™æ˜¯ä¸€ä¸ªæ·±åº¦ä¼˜å…ˆçš„è¿‡ç¨‹ã€‚")]),e._v(" "),t("li",[e._v("å°†æ¯ä¸€ä¸ªç¼–è¯‘åçš„æ¨¡å—ä¿å­˜è¿›å…¥this.modulesä¸­å»ã€‚")])]),e._v(" "),t("p",[e._v("æ¥ä¸‹æ¥æˆ‘ä»¬åªè¦ç¨ç¨åœ¨handleWebpackCompileræ–¹æ³•ä¸­ç¨ç¨æ”¹åŠ¨å°±å¯ä»¥äº†:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("// è°ƒç”¨webpackè¿›è¡Œæ¨¡å—ç¼–è¯‘\n  handleWebpackCompiler(moduleName, modulePath) {\n    // å°†å½“å‰æ¨¡å—ç›¸å¯¹äºé¡¹ç›®å¯åŠ¨æ ¹ç›®å½•è®¡ç®—å‡ºç›¸å¯¹è·¯å¾„ ä½œä¸ºæ¨¡å—ID\n    const moduleId = './' + path.posix.relative(this.rootPath, modulePath);\n    // åˆ›å»ºæ¨¡å—å¯¹è±¡\n    const module = {\n      id: moduleId,\n      dependencies: new Set(), // è¯¥æ¨¡å—æ‰€ä¾èµ–æ¨¡å—ç»å¯¹è·¯å¾„åœ°å€\n      name: [moduleName], // è¯¥æ¨¡å—æ‰€å±çš„å…¥å£æ–‡ä»¶\n    };\n    // è°ƒç”¨babelåˆ†ææˆ‘ä»¬çš„ä»£ç \n    const ast = parser.parse(this.moduleCode, {\n      sourceType: 'module',\n    });\n    // æ·±åº¦ä¼˜å…ˆ éå†è¯­æ³•Tree\n    traverse(ast, {\n      // å½“é‡åˆ°requireè¯­å¥æ—¶\n      CallExpression: (nodePath) => {\n        const node = nodePath.node;\n        if (node.callee.name === 'require') {\n          // è·å¾—æºä»£ç ä¸­å¼•å…¥æ¨¡å—ç›¸å¯¹è·¯å¾„\n          const requirePath = node.arguments[0].value;\n          // å¯»æ‰¾æ¨¡å—ç»å¯¹è·¯å¾„ å½“å‰æ¨¡å—è·¯å¾„+require()å¯¹åº”ç›¸å¯¹è·¯å¾„\n          const moduleDirName = path.posix.dirname(requirePath);\n          const absolutePath = tryExtensions(\n            path.posix.join(moduleDirName, requirePath),\n            this.options.resolve.extensions,\n            moduleName,\n            moduleDirName\n          );\n          // ç”ŸæˆmoduleId - é’ˆå¯¹äºè·Ÿè·¯å¾„çš„æ¨¡å—ID æ·»åŠ è¿›å…¥æ–°çš„ä¾èµ–æ¨¡å—è·¯å¾„\n          const moduleId =\n            './' + path.posix.relative(this.rootPath, absolutePath);\n          // é€šè¿‡babelä¿®æ”¹æºä»£ç ä¸­çš„requireå˜æˆ__webpack_require__è¯­å¥\n          node.callee = t.identifier('__webpack_require__');\n          // ä¿®æ”¹æºä»£ç ä¸­requireè¯­å¥å¼•å…¥çš„æ¨¡å— å…¨éƒ¨ä¿®æ”¹å˜ä¸ºç›¸å¯¹äºè·Ÿè·¯å¾„æ¥å¤„ç†\n          node.arguments = [t.stringLiteral(moduleId)];\n          // ä¸ºå½“å‰æ¨¡å—æ·»åŠ requireè¯­å¥é€ æˆçš„ä¾èµ–(å†…å®¹ä¸ºç›¸å¯¹äºæ ¹è·¯å¾„çš„æ¨¡å—ID)\n          module.dependencies.add(moduleId);\n        }\n      },\n    });\n    // éå†ç»“æŸæ ¹æ®ASTç”Ÿæˆæ–°çš„ä»£ç \n    const { code } = generator(ast);\n    // ä¸ºå½“å‰æ¨¡å—æŒ‚è½½æ–°çš„ç”Ÿæˆçš„ä»£ç \n    module._source = code;\n    // é€’å½’ä¾èµ–æ·±åº¦éå† å­˜åœ¨ä¾èµ–æ¨¡å—åˆ™åŠ å…¥\n    module.dependencies.forEach((dependency) => {\n      const depModule = this.buildModule(moduleName, dependency);\n      // å°†ç¼–è¯‘åçš„ä»»ä½•ä¾èµ–æ¨¡å—å¯¹è±¡åŠ å…¥åˆ°moduleså¯¹è±¡ä¸­å»\n      this.modules.add(depModule);\n    });\n    // è¿”å›å½“å‰æ¨¡å—å¯¹è±¡\n    return module;\n  }\n")])])]),t("p",[e._v("è¿™é‡Œæˆ‘ä»¬æ·»åŠ äº†è¿™æ ·ä¸€æ®µä»£ç :")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("// é€’å½’ä¾èµ–æ·±åº¦éå† å­˜åœ¨ä¾èµ–æ¨¡å—åˆ™åŠ å…¥\n    module.dependencies.forEach((dependency) => {\n      const depModule = this.buildModule(moduleName, dependency);\n      // å°†ç¼–è¯‘åçš„ä»»ä½•ä¾èµ–æ¨¡å—å¯¹è±¡åŠ å…¥åˆ°moduleså¯¹è±¡ä¸­å»\n      this.modules.add(depModule);\n    });\n")])])]),t("p",[e._v("è¿™é‡Œæˆ‘ä»¬å¯¹äºä¾èµ–çš„æ¨¡å—è¿›è¡Œäº†é€’å½’è°ƒç”¨buildModule,å°†è¾“å‡ºçš„æ¨¡å—å¯¹è±¡æ·»åŠ è¿›å…¥äº†this.modulesä¸­å»ã€‚\næ­¤æ—¶è®©æˆ‘ä»¬é‡æ–°è¿è¡Œwebpack/core/index.jsè¿›è¡Œç¼–è¯‘ï¼Œè¿™é‡Œæˆ‘åœ¨buildEntryModuleç¼–è¯‘ç»“æŸåæ‰“å°äº†assetså’Œmodules:\n"),t("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d5b1eb97de7c44919ab8f57635d3ab13~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?",alt:"image"}})]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("Set {\n  {\n    id: './example/src/entry1.js',\n    dependencies: Set { './example/src/module.js' },\n    name: [ 'main' ],\n    _source: 'const depModule = __webpack_require__(\"./example/src/module.js\");\\n' +\n      '\\n' +\n      \"console.log(depModule, 'dep');\\n\" +\n      \"console.log('This is entry 1 !');\\n\" +\n      \"const loader2 = '19Qingfeng';\\n\" +\n      \"const loader1 = 'https://github.com/19Qingfeng';\"\n  },\n  {\n    id: './example/src/entry2.js',\n    dependencies: Set { './example/src/module.js' },\n    name: [ 'second' ],\n    _source: 'const depModule = __webpack_require__(\"./example/src/module.js\");\\n' +\n      '\\n' +\n      \"console.log(depModule, 'dep');\\n\" +\n      \"console.log('This is entry 2 !');\\n\" +\n      \"const loader2 = '19Qingfeng';\\n\" +\n      \"const loader1 = 'https://github.com/19Qingfeng';\"\n  }\n} entries\nSet {\n  {\n    id: './example/src/module.js',\n    dependencies: Set {},\n    name: [ 'main' ],\n    _source: \"const name = '19Qingfeng';\\n\" +\n      'module.exports = {\\n' +\n      '  name\\n' +\n      '};\\n' +\n      \"const loader2 = '19Qingfeng';\\n\" +\n      \"const loader1 = 'https://github.com/19Qingfeng';\"\n  },\n  {\n    id: './example/src/module.js',\n    dependencies: Set {},\n    name: [ 'second' ],\n    _source: \"const name = '19Qingfeng';\\n\" +\n      'module.exports = {\\n' +\n      '  name\\n' +\n      '};\\n' +\n      \"const loader2 = '19Qingfeng';\\n\" +\n      \"const loader1 = 'https://github.com/19Qingfeng';\"\n  }\n} modules\n")])])]),t("p",[e._v("å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å·²ç»å°†module.jsè¿™ä¸ªä¾èµ–å¦‚æ„¿ä»¥å¿åŠ å…¥åˆ°modulesä¸­äº†ï¼ŒåŒæ—¶å®ƒä¹Ÿç»è¿‡loaderçš„å¤„ç†ã€‚ä½†æ˜¯æˆ‘ä»¬å‘ç°å®ƒè¢«é‡å¤åŠ å…¥äº†ä¸¤æ¬¡ã€‚")]),e._v(" "),t("p",[e._v("è¿™æ˜¯å› ä¸ºmodule.jsè¿™ä¸ªæ¨¡å—è¢«å¼•ç”¨äº†ä¸¤æ¬¡ï¼Œå®ƒè¢«entry1å’Œentry2éƒ½å·²è¿›è¡Œäº†ä¾èµ–ï¼Œåœ¨è¿›è¡Œé€’å½’ç¼–è¯‘æ—¶æˆ‘ä»¬è¿›è¡Œäº†ä¸¤æ¬¡buildModuleç›¸åŒæ¨¡å—ã€‚")]),e._v(" "),t("p",[e._v("è®©æˆ‘ä»¬æ¥å¤„ç†ä¸‹è¿™ä¸ªé—®é¢˜:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("handleWebpackCompiler(moduleName, modulePath) {\n       ...\n        // é€šè¿‡babelä¿®æ”¹æºä»£ç ä¸­çš„requireå˜æˆ__webpack_require__è¯­å¥\n          node.callee = t.identifier('__webpack_require__');\n          // ä¿®æ”¹æºä»£ç ä¸­requireè¯­å¥å¼•å…¥çš„æ¨¡å— å…¨éƒ¨ä¿®æ”¹å˜ä¸ºç›¸å¯¹äºè·Ÿè·¯å¾„æ¥å¤„ç†\n          node.arguments = [t.stringLiteral(moduleId)];\n          // è½¬åŒ–ä¸ºidsçš„æ•°ç»„ å¥½å¤„ç†\n          const alreadyModules = Array.from(this.modules).map((i) => i.id);\n          if (!alreadyModules.includes(moduleId)) {\n            // ä¸ºå½“å‰æ¨¡å—æ·»åŠ requireè¯­å¥é€ æˆçš„ä¾èµ–(å†…å®¹ä¸ºç›¸å¯¹äºæ ¹è·¯å¾„çš„æ¨¡å—ID)\n            module.dependencies.add(moduleId);\n          } else {\n            // å·²ç»å­˜åœ¨çš„è¯ è™½ç„¶ä¸è¿›è¡Œæ·»åŠ è¿›å…¥æ¨¡å—ç¼–è¯‘ ä½†æ˜¯ä»è¦æ›´æ–°è¿™ä¸ªæ¨¡å—ä¾èµ–çš„å…¥å£\n            this.modules.forEach((value) => {\n              if (value.id === moduleId) {\n                value.name.push(moduleName);\n              }\n            });\n          }\n        }\n      },\n    });\n    ...\n    }\n")])])]),t("p",[e._v("è¿™é‡Œåœ¨æ¯ä¸€æ¬¡ä»£ç åˆ†æçš„ä¾èµ–è½¬åŒ–ä¸­ï¼Œé¦–å…ˆåˆ¤æ–­this.moduleå¯¹è±¡æ˜¯å¦å·²ç»å­˜åœ¨å½“å‰æ¨¡å—äº†ï¼ˆé€šè¿‡å”¯ä¸€çš„æ¨¡å—idè·¯å¾„åˆ¤æ–­ï¼‰ã€‚")]),e._v(" "),t("p",[e._v("å¦‚æœä¸å­˜åœ¨åˆ™æ·»åŠ è¿›å…¥ä¾èµ–ä¸­è¿›è¡Œç¼–è¯‘ï¼Œå¦‚æœè¯¥æ¨¡å—å·²ç»å­˜åœ¨è¿‡äº†å°±è¯æ˜è¿™ä¸ªæ¨¡å—å·²ç»è¢«ç¼–è¯‘è¿‡äº†ã€‚æ‰€ä»¥æ­¤æ—¶æˆ‘ä»¬ä¸éœ€è¦å°†å®ƒå†æ¬¡è¿›è¡Œç¼–è¯‘ï¼Œæˆ‘ä»¬ä»…ä»…éœ€è¦æ›´æ–°è¿™ä¸ªæ¨¡å—æ‰€å±çš„chunkï¼Œä¸ºå®ƒçš„nameå±æ€§æ·»åŠ å½“å‰æ‰€å±çš„chunkåç§°ã€‚")]),e._v(" "),t("p",[e._v("é‡æ–°è¿è¡Œï¼Œè®©æˆ‘ä»¬åœ¨æ¥çœ‹çœ‹æ‰“å°ç»“æœ:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("Set(2) {\n  {\n    id: './example/src/entry1.js',\n    dependencies: Set(1) { './example/src/module.js' },\n    name: [ 'main' ],\n    _source: 'const depModule = __webpack_require__(\"./example/src/module.js\");\\n' +\n      '\\n' +\n      \"console.log(depModule, 'dep');\\n\" +\n      \"console.log('This is entry 1 !');\\n\" +\n      \"const loader2 = '19Qingfeng';\\n\" +\n      \"const loader1 = 'https://github.com/19Qingfeng';\"\n  },\n  {\n    id: './example/src/entry2.js',\n    dependencies: Set(0) {},\n    name: [ 'second' ],\n    _source: 'const depModule = __webpack_require__(\"./example/src/module.js\");\\n' +\n      '\\n' +\n      \"console.log(depModule, 'dep');\\n\" +\n      \"console.log('This is entry 2 !');\\n\" +\n      \"const loader2 = '19Qingfeng';\\n\" +\n      \"const loader1 = 'https://github.com/19Qingfeng';\"\n  }\n} å…¥å£æ–‡ä»¶\nSet(1) {\n  {\n    id: './example/src/module.js',\n    dependencies: Set(0) {},\n    name: [ 'main', 'second' ],\n    _source: \"const name = '19Qingfeng';\\n\" +\n      'module.exports = {\\n' +\n      '  name\\n' +\n      '};\\n' +\n      \"const loader2 = '19Qingfeng';\\n\" +\n      \"const loader1 = 'https://github.com/19Qingfeng';\"\n  }\n} modules\n")])])]),t("p",[e._v("æ­¤æ—¶é’ˆå¯¹æˆ‘ä»¬çš„â€œæ¨¡å—ç¼–è¯‘é˜¶æ®µâ€åŸºæœ¬å·²ç»ç»“æŸäº†ï¼Œè¿™ä¸€æ­¥æˆ‘ä»¬å¯¹äºæ‰€æœ‰æ¨¡å—ä»å…¥å£æ–‡ä»¶å¼€å§‹è¿›è¡Œåˆ†æã€‚")]),e._v(" "),t("ul",[t("li",[e._v("ä»å…¥å£å‡ºå‘ï¼Œè¯»å–å…¥å£æ–‡ä»¶å†…å®¹è°ƒç”¨åŒ¹é…loaderå¤„ç†å…¥å£æ–‡ä»¶ã€‚")]),e._v(" "),t("li",[e._v("é€šè¿‡babelåˆ†æä¾èµ–ï¼Œå¹¶ä¸”åŒæ—¶å°†æ‰€æœ‰ä¾èµ–çš„è·¯å¾„æ›´æ¢ä¸ºç›¸å¯¹äºé¡¹ç›®å¯åŠ¨ç›®å½•options.contextçš„è·¯å¾„ã€‚")]),e._v(" "),t("li",[e._v("å…¥å£æ–‡ä»¶ä¸­å¦‚æœå­˜åœ¨ä¾èµ–çš„è¯ï¼Œé€’å½’ä¸Šè¿°æ­¥éª¤ç¼–è¯‘ä¾èµ–æ¨¡å—ã€‚")]),e._v(" "),t("li",[e._v("å°†æ¯ä¸ªä¾èµ–çš„æ¨¡å—ç¼–è¯‘åçš„å¯¹è±¡åŠ å…¥this.modulesã€‚")]),e._v(" "),t("li",[e._v("å°†æ¯ä¸ªå…¥å£æ–‡ä»¶ç¼–è¯‘åçš„å¯¹è±¡åŠ å…¥this.entriesã€‚")])]),e._v(" "),t("h2",{attrs:{id:"ç¼–è¯‘å®Œæˆé˜¶æ®µ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç¼–è¯‘å®Œæˆé˜¶æ®µ"}},[e._v("#")]),e._v(" ç¼–è¯‘å®Œæˆé˜¶æ®µ")]),e._v(" "),t("p",[e._v("åœ¨ä¸Šä¸€æ­¥æˆ‘ä»¬å®Œæˆäº†æ¨¡å—ä¹‹é—´çš„ç¼–è¯‘ï¼Œå¹¶ä¸”ä¸ºmoduleå’Œentryåˆ†åˆ«å¡«å……äº†å†…å®¹ã€‚")]),e._v(" "),t("p",[e._v("åœ¨å°†æ‰€æœ‰æ¨¡å—é€’å½’ç¼–è¯‘å®Œæˆåï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®ä¸Šè¿°çš„ä¾èµ–å…³ç³»ï¼Œç»„åˆæœ€ç»ˆè¾“å‡ºçš„chunkæ¨¡å—ã€‚")]),e._v(" "),t("p",[e._v("è®©æˆ‘ä»¬æ¥ç»§ç»­æ”¹é€ æˆ‘ä»¬çš„Compilerå§:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("class Compiler {\n\n    // ...\n    buildEntryModule(entry) {\n        Object.keys(entry).forEach((entryName) => {\n          const entryPath = entry[entryName];\n          // è°ƒç”¨buildModuleå®ç°çœŸæ­£çš„æ¨¡å—ç¼–è¯‘é€»è¾‘\n          const entryObj = this.buildModule(entryName, entryPath);\n          this.entries.add(entryObj);\n          // æ ¹æ®å½“å‰å…¥å£æ–‡ä»¶å’Œæ¨¡å—çš„ç›¸äº’ä¾èµ–å…³ç³»ï¼Œç»„è£…æˆä¸ºä¸€ä¸ªä¸ªåŒ…å«å½“å‰å…¥å£æ‰€æœ‰ä¾èµ–æ¨¡å—çš„chunk\n          this.buildUpChunk(entryName, entryObj);\n        });\n        console.log(this.chunks, 'chunks');\n    }\n    \n     // æ ¹æ®å…¥å£æ–‡ä»¶å’Œä¾èµ–æ¨¡å—ç»„è£…chunks\n      buildUpChunk(entryName, entryObj) {\n        const chunk = {\n          name: entryName, // æ¯ä¸€ä¸ªå…¥å£æ–‡ä»¶ä½œä¸ºä¸€ä¸ªchunk\n          entryModule: entryObj, // entryç¼–è¯‘åçš„å¯¹è±¡\n          modules: Array.from(this.modules).filter((i) =>\n            i.name.includes(entryName)\n          ), // å¯»æ‰¾ä¸å½“å‰entryæœ‰å…³çš„æ‰€æœ‰module\n        };\n        // å°†chunkæ·»åŠ åˆ°this.chunksä¸­å»\n        this.chunks.add(chunk);\n      }\n      \n      // ...\n}\n")])])]),t("p",[e._v("è¿™é‡Œï¼Œæˆ‘ä»¬æ ¹æ®å¯¹åº”çš„å…¥å£æ–‡ä»¶é€šè¿‡æ¯ä¸€ä¸ªæ¨¡å—(module)çš„nameå±æ€§æŸ¥æ‰¾å¯¹åº”å…¥å£çš„æ‰€æœ‰ä¾èµ–æ–‡ä»¶ã€‚")]),e._v(" "),t("p",[e._v("æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹this.chunksæœ€ç»ˆä¼šè¾“å‡ºä»€ä¹ˆ:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("Set {\n  {\n    name: 'main',\n    entryModule: {\n      id: './example/src/entry1.js',\n      dependencies: [Set],\n      name: [Array],\n      _source: 'const depModule = __webpack_require__(\"./example/src/module.js\");\\n' +\n        '\\n' +\n        \"console.log(depModule, 'dep');\\n\" +\n        \"console.log('This is entry 1 !');\\n\" +\n        \"const loader2 = '19Qingfeng';\\n\" +\n        \"const loader1 = 'https://github.com/19Qingfeng';\"\n    },\n    modules: [ [Object] ]\n  },\n  {\n    name: 'second',\n    entryModule: {\n      id: './example/src/entry2.js',\n      dependencies: Set {},\n      name: [Array],\n      _source: 'const depModule = __webpack_require__(\"./example/src/module.js\");\\n' +\n        '\\n' +\n        \"console.log(depModule, 'dep');\\n\" +\n        \"console.log('This is entry 2 !');\\n\" +\n        \"const loader2 = '19Qingfeng';\\n\" +\n        \"const loader1 = 'https://github.com/19Qingfeng';\"\n    },\n    modules: []\n  }\n}\n")])])]),t("p",[e._v("è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬å¾—åˆ°äº†Webpackä¸­æœ€ç»ˆè¾“å‡ºçš„ä¸¤ä¸ªchunkã€‚\nå®ƒä»¬åˆ†åˆ«æ‹¥æœ‰:")]),e._v(" "),t("ul",[t("li",[e._v("name:å½“å‰å…¥å£æ–‡ä»¶çš„åç§°")]),e._v(" "),t("li",[e._v("entryModule: å…¥å£æ–‡ä»¶ç¼–è¯‘åçš„å¯¹è±¡ã€‚")]),e._v(" "),t("li",[e._v("modules: è¯¥å…¥å£æ–‡ä»¶ä¾èµ–çš„æ‰€æœ‰æ¨¡å—å¯¹è±¡ç»„æˆçš„æ•°ç»„ï¼Œå…¶ä¸­æ¯ä¸€ä¸ªå…ƒç´ çš„æ ¼å¼å’ŒentryModuleæ˜¯ä¸€è‡´çš„ã€‚")])]),e._v(" "),t("p",[e._v("æ­¤æ—¶ç¼–è¯‘å®Œæˆæˆ‘ä»¬æ‹¼è£…chunkçš„ç¯èŠ‚å°±åœ†æ»¡å®Œæˆã€‚")]),e._v(" "),t("h2",{attrs:{id:"è¾“å‡ºæ–‡ä»¶é˜¶æ®µ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#è¾“å‡ºæ–‡ä»¶é˜¶æ®µ"}},[e._v("#")]),e._v(" è¾“å‡ºæ–‡ä»¶é˜¶æ®µ")]),e._v(" "),t("p",[e._v("æˆ‘ä»¬å…ˆæ”¾ä¸€ä¸‹ä¸Šä¸€æ­¥æ‰€æœ‰ç¼–è¯‘å®Œæˆåæ‹¼è£…å‡ºæ¥çš„this.chunksã€‚")]),e._v(" "),t("h3",{attrs:{id:"åˆ†æåŸå§‹æ‰“åŒ…è¾“å‡ºç»“æœ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åˆ†æåŸå§‹æ‰“åŒ…è¾“å‡ºç»“æœ"}},[e._v("#")]),e._v(" åˆ†æåŸå§‹æ‰“åŒ…è¾“å‡ºç»“æœ")]),e._v(" "),t("p",[e._v("è¿™é‡Œï¼Œæˆ‘æŠŠwebpack/core/index.jsä¸­åšäº†å¦‚ä¸‹ä¿®æ”¹:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("- const webpack = require('./webpack');\n+ const webpack = require('webpack')\n\n...\n")])])]),t("p",[e._v("è¿ç”¨åŸæœ¬çš„webpackä»£æ›¿æˆ‘ä»¬è‡ªå·±å®ç°çš„webpackå…ˆè¿›è¡Œä¸€æ¬¡æ‰“åŒ…ã€‚")]),e._v(" "),t("p",[e._v("è¿è¡Œwebpack/core/index.jsåï¼Œæˆ‘ä»¬ä¼šåœ¨webpack/src/buildä¸­å¾—åˆ°ä¸¤ä¸ªæ–‡ä»¶:main.jså’Œsecond.js,æˆ‘ä»¬ä»¥å…¶ä¸­ä¸€ä¸ªmain.jsæ¥çœ‹çœ‹å®ƒçš„å†…å®¹:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("(() => {\n  var __webpack_modules__ = {\n    './example/src/module.js': (module) => {\n      const name = '19Qingfeng';\n\n      module.exports = {\n        name,\n      };\n\n      const loader2 = '19Qingfeng';\n      const loader1 = 'https://github.com/19Qingfeng';\n    },\n  };\n  // The module cache\n  var __webpack_module_cache__ = {};\n\n  // The require function\n  function __webpack_require__(moduleId) {\n    // Check if module is in cache\n    var cachedModule = __webpack_module_cache__[moduleId];\n    if (cachedModule !== undefined) {\n      return cachedModule.exports;\n    }\n    // Create a new module (and put it into the cache)\n    var module = (__webpack_module_cache__[moduleId] = {\n      // no module.id needed\n      // no module.loaded needed\n      exports: {},\n    });\n\n    // Execute the module function\n    __webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n    // Return the exports of the module\n    return module.exports;\n  }\n\n  var __webpack_exports__ = {};\n  // This entry need to be wrapped in an IIFE because it need to be isolated against other modules in the chunk.\n  (() => {\n    const depModule = __webpack_require__(\n      /*! ./module */ './example/src/module.js'\n    );\n\n    console.log(depModule, 'dep');\n    console.log('This is entry 1 !');\n\n    const loader2 = '19Qingfeng';\n    const loader1 = 'https://github.com/19Qingfeng';\n  })();\n})();\n\n")])])]),t("blockquote",[t("p",[e._v("è¿™é‡Œæˆ‘æ‰‹åŠ¨åˆ é™¤äº†æ‰“åŒ…ç”Ÿæˆåçš„å¤šä½™æ³¨é‡Šï¼Œç²¾ç®€äº†ä»£ç ã€‚")])]),e._v(" "),t("p",[e._v("æˆ‘ä»¬æ¥ç¨å¾®åˆ†æä¸€ä¸‹åŸå§‹æ‰“åŒ…ç”Ÿæˆçš„ä»£ç ï¼š")]),e._v(" "),t("p",[e._v("webpackæ‰“åŒ…åçš„ä»£ç å†…éƒ¨å®šä¹‰äº†ä¸€ä¸ª__webpack_require__çš„å‡½æ•°ä»£æ›¿äº†NodeJså†…éƒ¨çš„requireæ–¹æ³•ã€‚\nåŒæ—¶åº•éƒ¨çš„\n"),t("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/28cda8e5306548d3925a4e36b8547b62~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?",alt:"image"}})]),e._v(" "),t("p",[e._v("è¿™å—ä»£ç ç›¸æ¯”å¤§å®¶éƒ½å¾ˆç†Ÿæ‚‰å§ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬ç¼–è¯‘åçš„å…¥å£æ–‡ä»¶ä»£ç ã€‚åŒæ—¶é¡¶éƒ¨çš„ä»£ç æ˜¯è¯¥å…¥å£æ–‡ä»¶ä¾èµ–çš„æ‰€æœ‰æ¨¡å—å®šä¹‰çš„ä¸€ä¸ªå¯¹è±¡:")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/78f606cc93cd4773befe0d7589f75217~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?",alt:"image"}})]),e._v(" "),t("p",[e._v("è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ª__webpack__modulesçš„å¯¹è±¡ï¼Œ**å¯¹è±¡çš„keyä¸ºè¯¥ä¾èµ–æ¨¡å—ç›¸å¯¹äºè·Ÿè·¯å¾„çš„ç›¸å¯¹è·¯å¾„ï¼Œå¯¹è±¡çš„valueè¯¥ä¾èµ–æ¨¡å—ç¼–è¯‘åçš„ä»£ç ã€‚`")]),e._v(" "),t("h3",{attrs:{id:"è¾“å‡ºæ–‡ä»¶é˜¶æ®µ-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#è¾“å‡ºæ–‡ä»¶é˜¶æ®µ-2"}},[e._v("#")]),e._v(" è¾“å‡ºæ–‡ä»¶é˜¶æ®µ")]),e._v(" "),t("p",[e._v("æ¥ä¸‹é‡Œåœ¨åˆ†æå®ŒwebpackåŸå§‹æ‰“åŒ…åçš„ä»£ç ä¹‹åï¼Œä¸Šæˆ‘ä»¬æ¥ç»§ç»­ä¸Šä¸€æ­¥ã€‚é€šè¿‡æˆ‘ä»¬çš„this.chunksæ¥å°è¯•è¾“å‡ºæœ€ç»ˆçš„æ•ˆæœå§ã€‚")]),e._v(" "),t("p",[e._v("è®©æˆ‘ä»¬å›åˆ°Compilerä¸Šçš„runæ–¹æ³•ä¸­:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("class Compiler {\n   \n   }\n  // runæ–¹æ³•å¯åŠ¨ç¼–è¯‘\n  // åŒæ—¶runæ–¹æ³•æ¥å—å¤–éƒ¨ä¼ é€’çš„callback\n  run(callback) {\n    // å½“è°ƒç”¨runæ–¹å¼æ—¶ è§¦å‘å¼€å§‹ç¼–è¯‘çš„plugin\n    this.hooks.run.call();\n    // è·å–å…¥å£é…ç½®å¯¹è±¡\n    const entry = this.getEntry();\n    // ç¼–è¯‘å…¥å£æ–‡ä»¶\n    this.buildEntryModule(entry);\n    // å¯¼å‡ºåˆ—è¡¨;ä¹‹åå°†æ¯ä¸ªchunkè½¬åŒ–ç§°ä¸ºå•ç‹¬çš„æ–‡ä»¶åŠ å…¥åˆ°è¾“å‡ºåˆ—è¡¨assetsä¸­\n    this.exportFile(callback);\n  }\n")])])]),t("p",[e._v("æˆ‘ä»¬åœ¨buildEntryModuleæ¨¡å—ç¼–è¯‘å®Œæˆä¹‹åï¼Œé€šè¿‡this.exportFileæ–¹æ³•å®ç°å¯¼å‡ºæ–‡ä»¶çš„é€»è¾‘ã€‚\nè®©æˆ‘ä»¬æ¥ä¸€èµ·çœ‹çœ‹this.exportFileæ–¹æ³•:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("// å°†chunkåŠ å…¥è¾“å‡ºåˆ—è¡¨ä¸­å»\n  exportFile(callback) {\n    const output = this.options.output;\n    // æ ¹æ®chunksç”Ÿæˆassetså†…å®¹\n    this.chunks.forEach((chunk) => {\n      const parseFileName = output.filename.replace('[name]', chunk.name);\n      // assetsä¸­ { 'main.js': 'ç”Ÿæˆçš„å­—ç¬¦ä¸²ä»£ç ...' }\n      this.assets[parseFileName] = getSourceCode(chunk);\n    });\n    // è°ƒç”¨Plugin emité’©å­\n    this.hooks.emit.call();\n    // å…ˆåˆ¤æ–­ç›®å½•æ˜¯å¦å­˜åœ¨ å­˜åœ¨ç›´æ¥fs.write ä¸å­˜åœ¨åˆ™é¦–å…ˆåˆ›å»º\n    if (!fs.existsSync(output.path)) {\n      fs.mkdirSync(output.path);\n    }\n    // filesä¸­ä¿å­˜æ‰€æœ‰çš„ç”Ÿæˆæ–‡ä»¶å\n    this.files = Object.keys(this.assets);\n    // å°†assetsä¸­çš„å†…å®¹ç”Ÿæˆæ‰“åŒ…æ–‡ä»¶ å†™å…¥æ–‡ä»¶ç³»ç»Ÿä¸­\n    Object.keys(this.assets).forEach((fileName) => {\n      const filePath = path.join(output.path, fileName);\n      fs.writeFileSync(filePath, this.assets[fileName]);\n    });\n    // ç»“æŸä¹‹åè§¦å‘é’©å­\n    this.hooks.done.call();\n    callback(null, {\n      toJson: () => {\n        return {\n          entries: this.entries,\n          modules: this.modules,\n          files: this.files,\n          chunks: this.chunks,\n          assets: this.assets,\n        };\n      },\n    });\n  }\n")])])]),t("p",[e._v("exportFileåšäº†å¦‚ä¸‹å‡ ä»¶äº‹:")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("é¦–å…ˆè·å–é…ç½®å‚æ•°çš„è¾“å‡ºé…ç½®ï¼Œè¿­ä»£æˆ‘ä»¬çš„this.chunksï¼Œå°†output.filenameä¸­çš„[name]æ›¿æ¢ç§°ä¸ºå¯¹åº”çš„å…¥å£æ–‡ä»¶åç§°ã€‚åŒæ—¶æ ¹æ®chunksçš„å†…å®¹ä¸ºthis.assetsä¸­æ·»åŠ éœ€è¦æ‰“åŒ…ç”Ÿæˆçš„æ–‡ä»¶åå’Œæ–‡ä»¶å†…å®¹ã€‚")])]),e._v(" "),t("li",[t("p",[e._v("å°†æ–‡ä»¶å†™å…¥ç£ç›˜å‰è°ƒç”¨pluginçš„emité’©å­å‡½æ•°ã€‚")])]),e._v(" "),t("li",[t("p",[e._v("åˆ¤æ–­output.pathæ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™é€šè¿‡fsæ–°å»ºè¿™ä¸ªæ–‡ä»¶å¤¹ã€‚")])]),e._v(" "),t("li",[t("p",[e._v("å°†æœ¬æ¬¡æ‰“åŒ…ç”Ÿæˆçš„æ‰€æœ‰æ–‡ä»¶å(this.assetsçš„keyå€¼ç»„æˆçš„æ•°ç»„)å­˜æ”¾è¿›å…¥filesä¸­å»ã€‚")])]),e._v(" "),t("li",[t("p",[e._v("å¾ªç¯this.assetsï¼Œå°†æ–‡ä»¶ä¾æ¬¡å†™å…¥å¯¹åº”çš„ç£ç›˜ä¸­å»ã€‚")])]),e._v(" "),t("li",[t("p",[e._v("æ‰€æœ‰æ‰“åŒ…æµç¨‹ç»“æŸï¼Œè§¦å‘webpackæ’ä»¶çš„doneé’©å­ã€‚")])]),e._v(" "),t("li",[t("p",[e._v("åŒæ—¶ä¸ºNodeJs Webpack APiå‘¼åº”ï¼Œè°ƒç”¨runæ–¹æ³•ä¸­å¤–éƒ¨ä¼ å…¥çš„callbackä¼ å…¥ä¸¤ä¸ªå‚æ•°ã€‚")])])]),e._v(" "),t("p",[e._v("æ€»çš„æ¥è¯´ï¼Œthis.assetsåšçš„äº‹æƒ…ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯é€šè¿‡åˆ†æchunkså¾—åˆ°assetsç„¶åè¾“å‡ºå¯¹åº”çš„ä»£ç åˆ°ç£ç›˜ä¸­ã€‚")]),e._v(" "),t("p",[e._v("ä»”ç»†çœ‹è¿‡ä¸Šè¾¹ä»£ç ï¼Œä½ ä¼šå‘ç°ã€‚this.assetsè¿™ä¸ªMapä¸­æ¯ä¸€ä¸ªå…ƒç´ çš„valueæ˜¯é€šè¿‡è°ƒç”¨getSourceCode(chunk)æ–¹æ³•æ¥ç”Ÿæˆæ¨¡å—å¯¹åº”çš„ä»£ç çš„ã€‚")]),e._v(" "),t("p",[e._v("é‚£ä¹ˆgetSourceCodeè¿™ä¸ªæ–¹æ³•æ˜¯å¦‚ä½•æ ¹æ®chunkæ¥ç”Ÿæˆæˆ‘ä»¬æœ€ç»ˆç¼–è¯‘åçš„ä»£ç å‘¢ï¼Ÿè®©æˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹å§ï¼")]),e._v(" "),t("h3",{attrs:{id:"getsourcecodeæ–¹æ³•"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#getsourcecodeæ–¹æ³•"}},[e._v("#")]),e._v(" getSourceCodeæ–¹æ³•")]),e._v(" "),t("p",[e._v("é¦–å…ˆæˆ‘ä»¬æ¥ç®€å•æ˜ç¡®ä¸€ä¸‹è¿™ä¸ªæ–¹æ³•çš„èŒè´£ï¼Œæˆ‘ä»¬éœ€è¦getSourceCodeæ–¹æ³•æ¥å—ä¼ å…¥çš„chunkå¯¹è±¡ã€‚ä»è€Œè¿”å›è¯¥chunkçš„æºä»£ç ã€‚")]),e._v(" "),t("p",[e._v("åºŸè¯ä¸å¤šè¯´ï¼Œå…¶å®è¿™é‡Œæˆ‘ç”¨äº†ä¸€ä¸ªæ¯”è¾ƒå·æ‡’çš„åŠæ³•ï¼Œä½†æ˜¯å®Œå…¨ä¸å¦¨ç¢ä½ ç†è§£Webpackæµç¨‹ï¼Œä¸Šè¾¹æˆ‘ä»¬åˆ†æè¿‡åŸæœ¬webpackæ‰“åŒ…åçš„ä»£ç ä»…ä»…åªæœ‰å…¥å£æ–‡ä»¶å’Œæ¨¡å—ä¾èµ–æ˜¯æ¯æ¬¡æ‰“åŒ…ä¸åŒçš„åœ°æ–¹ï¼Œå…³äºrequireæ–¹æ³•ä¹‹ç±»éƒ½æ˜¯ç›¸é€šçš„ã€‚")]),e._v(" "),t("p",[e._v("æŠŠæ¡æ¯æ¬¡çš„ä¸åŒç‚¹ï¼Œæˆ‘ä»¬ç›´æ¥å…ˆæ¥çœ‹çœ‹å®ƒçš„å®ç°æ–¹å¼:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("// webpack/utils/index.js\n\n...\n\n\n/**\n *\n *\n * @param {*} chunk\n * nameå±æ€§å…¥å£æ–‡ä»¶åç§°\n * entryModuleå…¥å£æ–‡ä»¶moduleå¯¹è±¡\n * modules ä¾èµ–æ¨¡å—è·¯å¾„\n */\nfunction getSourceCode(chunk) {\n  const { name, entryModule, modules } = chunk;\n  return `\n  (() => {\n    var __webpack_modules__ = {\n      ${modules\n        .map((module) => {\n          return `\n          '${module.id}': (module) => {\n            ${module._source}\n      }\n        `;\n        })\n        .join(',')}\n    };\n    // The module cache\n    var __webpack_module_cache__ = {};\n\n    // The require function\n    function __webpack_require__(moduleId) {\n      // Check if module is in cache\n      var cachedModule = __webpack_module_cache__[moduleId];\n      if (cachedModule !== undefined) {\n        return cachedModule.exports;\n      }\n      // Create a new module (and put it into the cache)\n      var module = (__webpack_module_cache__[moduleId] = {\n        // no module.id needed\n        // no module.loaded needed\n        exports: {},\n      });\n\n      // Execute the module function\n      __webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n      // Return the exports of the module\n      return module.exports;\n    }\n\n    var __webpack_exports__ = {};\n    // This entry need to be wrapped in an IIFE because it need to be isolated against other modules in the chunk.\n    (() => {\n      ${entryModule._source}\n    })();\n  })();\n  `;\n}\n...\n\n")])])]),t("p",[e._v("è¿™æ®µä»£ç å…¶å®éå¸¸éå¸¸ç®€å•ï¼Œè¿œè¿œæ²¡æœ‰ä½ æƒ³è±¡çš„å¤šéš¾ï¼æœ‰ç‚¹è¿”ç’å½’çœŸçš„æ„Ÿè§‰æ˜¯å—å“ˆå“ˆã€‚")]),e._v(" "),t("p",[e._v("åœ¨getSourceCodeæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ç»„åˆè€Œæ¥çš„chunkè·å¾—å¯¹åº”çš„:")]),e._v(" "),t("ul",[t("li",[e._v("name: è¯¥å…¥å£æ–‡ä»¶å¯¹åº”è¾“å‡ºæ–‡ä»¶çš„åç§°ã€‚")]),e._v(" "),t("li",[e._v("entryModule: å­˜æ”¾è¯¥å…¥å£æ–‡ä»¶ç¼–è¯‘åçš„å¯¹è±¡ã€‚")]),e._v(" "),t("li",[e._v("modules:å­˜æ”¾è¯¥å…¥å£æ–‡ä»¶ä¾èµ–çš„æ‰€æœ‰æ¨¡å—çš„å¯¹è±¡ã€‚")])]),e._v(" "),t("p",[t("strong",[e._v("æˆ‘ä»¬é€šè¿‡å­—ç¬¦ä¸²æ‹¼æ¥çš„æ–¹å¼å»å®ç°äº†__webpack__moduleså¯¹è±¡ä¸Šçš„å±æ€§ï¼ŒåŒæ—¶ä¹Ÿåœ¨åº•éƒ¨é€šè¿‡${entryModule._source}æ‹¼æ¥å‡ºå…¥å£æ–‡ä»¶çš„ä»£ç ã€‚")])]),e._v(" "),t("blockquote",[t("p",[e._v("è¿™é‡Œæˆ‘ä»¬ä¸Šæ–‡æåˆ°è¿‡ä¸ºä»€ä¹ˆè¦å°†æ¨¡å—çš„requireæ–¹æ³•çš„è·¯å¾„è½¬åŒ–ä¸ºç›¸å¯¹äºè·Ÿè·¯å¾„(context)çš„è·¯å¾„ï¼Œçœ‹åˆ°è¿™é‡Œæˆ‘ç›¸ä¿¡ä¸ºä»€ä¹ˆè¿™ä¹ˆåšå¤§å®¶éƒ½å·²ç»äº†ç„¶äºèƒ¸äº†ã€‚å› ä¸ºæˆ‘ä»¬æœ€ç»ˆå®ç°çš„__webpack_require__æ–¹æ³•å…¨éƒ½æ˜¯é’ˆå¯¹äºæ¨¡å—è·Ÿè·¯å¾„çš„ç›¸å¯¹è·¯å¾„è‡ªå·±å®ç°çš„requireæ–¹æ³•ã€‚")])]),e._v(" "),t("blockquote",[t("p",[e._v("åŒæ—¶å¦‚æœä¸å¤ªæ¸…æ¥šrequireæ–¹æ³•æ˜¯å¦‚ä½•è½¬å˜ç§°ä¸º__webpack_require__æ–¹æ³•çš„åŒå­¦å¯ä»¥é‡æ–°å›åˆ°æˆ‘ä»¬çš„ç¼–è¯‘ç« èŠ‚ä»”ç»†å¤ä¹ ç†¬ï½æˆ‘ä»¬é€šè¿‡babelåœ¨ASTè½¬åŒ–é˜¶æ®µå°†requireæ–¹æ³•è°ƒç”¨å˜æˆäº†__webpack_require__ã€‚")])]),e._v(" "),t("h2",{attrs:{id:"å¤§åŠŸå‘Šæˆ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å¤§åŠŸå‘Šæˆ"}},[e._v("#")]),e._v(" å¤§åŠŸå‘Šæˆ")]),e._v(" "),t("p",[e._v("è‡³æ­¤ï¼Œè®©æˆ‘ä»¬å›åˆ°webpack/core/index.jsä¸­å»ã€‚é‡æ–°è¿è¡Œè¿™ä¸ªæ–‡ä»¶ï¼Œä½ ä¼šå‘ç°webpack/exampleç›®å½•ä¸‹ä¼šå¤šå‡ºä¸€ä¸ªbuildç›®å½•ã€‚")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d5ec0529023c4b89a1cd2900d4dd8d5b~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?",alt:"image"}})]),e._v(" "),t("p",[e._v("è¿™ä¸€æ­¥æˆ‘ä»¬å°±å®Œç¾çš„å®ç°å±äºæˆ‘ä»¬è‡ªå·±çš„webpackã€‚")]),e._v(" "),t("p",[e._v("å®è´¨ä¸Šï¼Œæˆ‘ä»¬å¯¹äºå®ç°ä¸€ä¸ªç®€å•ç‰ˆçš„webpackæ ¸å¿ƒæˆ‘è¿˜æ˜¯å¸Œæœ›å¤§å®¶å¯ä»¥åœ¨ç†è§£å®ƒçš„å·¥ä½œæµçš„åŒæ—¶å½»åº•ç†è§£compilerè¿™ä¸ªå¯¹è±¡ã€‚")]),e._v(" "),t("p",[e._v("åœ¨ä¹‹åçš„ä»»ä½•å…³äºwebpackç›¸å…³åº•å±‚å¼€å‘ä¸­ï¼ŒçœŸæ­£åšåˆ°å¯¹äºcompilerçš„ç”¨æ³•äº†ç„¶äºèƒ¸ã€‚äº†è§£compilerä¸Šçš„å„ç§å±æ€§æ˜¯å¦‚ä½•å½±å“åˆ°ç¼–è¯‘æ‰“åŒ…ç»“æœçš„ã€‚")]),e._v(" "),t("p",[e._v("è®©æˆ‘ä»¬ç”¨ä¸€å¼ æµç¨‹å›¾æ¥è¿›è¡Œä¸€ä¸ªå®Œç¾çš„æ”¶å°¾å§:\n"),t("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/851da6ae496d45b29e3897bd8282b691~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?",alt:"image"}})]),e._v(" "),t("h2",{attrs:{id:"å†™åœ¨æœ€å"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å†™åœ¨æœ€å"}},[e._v("#")]),e._v(" å†™åœ¨æœ€å")]),e._v(" "),t("p",[e._v("é¦–å…ˆï¼Œæ„Ÿè°¢æ¯ä¸€ä½å¯ä»¥çœ‹åˆ°è¿™é‡Œçš„åŒå­¦ã€‚")]),e._v(" "),t("p",[e._v("è¿™ç¯‡æ–‡ç« ç›¸å¯¹æœ‰ä¸€å®šçš„çŸ¥è¯†é—¨æ§›å¹¶ä¸”ä»£ç éƒ¨åˆ†å±…å¤šï¼Œæ•¬ä½©æ¯ä¸€ä½å¯ä»¥è¯»åˆ°ç»“å°¾çš„åŒå­¦ã€‚")]),e._v(" "),t("p",[e._v("æ–‡ç« ä¸­å¯¹äºå®ç°ä¸€ä¸ªç®€æ˜“ç‰ˆçš„Webpackåœ¨è¿™é‡Œå°±è¦å’Œå¤§å®¶å‘Šä¸€æ®µè½äº†ï¼Œè¿™å…¶å®åªæ˜¯ä¸€ä¸ªæœ€åŸºç¡€ç‰ˆæœ¬çš„webpackå·¥ä½œæµã€‚\nä½†æ˜¯æ­£æ˜¯é€šè¿‡è¿™æ ·ä¸€ä¸ªå°ğŸŒ°å¯ä»¥å¸¦æˆ‘ä»¬çœŸæ­£å…¥é—¨webpackçš„æ ¸å¿ƒå·¥ä½œæµï¼Œå¸Œæœ›è¿™ç¯‡æ–‡ç« å¯¹äºå¤§å®¶ç†è§£webpackæ—¶å¯ä»¥èµ·åˆ°æ›´å¥½çš„è¾…åŠ©ä½œç”¨ã€‚")]),e._v(" "),t("p",[e._v("å…¶å®åœ¨ç†è§£æ¸…æ¥šåŸºç¡€çš„å·¥ä½œæµä¹‹åï¼Œé’ˆå¯¹äºloaderå’Œpluginå¼€å‘éƒ½æ˜¯ä¿¡æ‰‹æ‹ˆæ¥çš„éƒ¨åˆ†ï¼Œæ–‡ç« ä¸­å¯¹äºè¿™ä¸¤éƒ¨åˆ†å†…å®¹çš„å¼€å‘ä»‹ç»æ¯”è¾ƒè‚¤æµ…ï¼Œåç»­æˆ‘ä¼šåˆ†åˆ«æ›´æ–°æœ‰å…³loaderå’Œpluginçš„è¯¦ç»†å¼€å‘æµç¨‹ã€‚æœ‰å…´è¶£çš„åŒå­¦å¯ä»¥åŠæ—¶å…³æ³¨ğŸ˜„ã€‚")]),e._v(" "),t("p",[e._v("æ–‡ç« ä¸­çš„ä»£ç ä½ å¯ä»¥åœ¨è¿™é‡Œä¸‹è½½ï¼Œè¿™ä»½ç®€æ˜“ç‰ˆçš„webpackæˆ‘ä¹Ÿä¼šæŒç»­åœ¨ä»£ç åº“ä¸­å®Œå–„æ›´å¤šå·¥ä½œæµçš„é€»è¾‘å¤„ç†ã€‚")]),e._v(" "),t("p",[e._v("åŒæ—¶è¿™é‡Œè¿™é‡Œçš„ä»£ç æˆ‘æƒ³å¼ºè°ƒçš„æ˜¯æºç æµç¨‹çš„è®²è§£ï¼ŒçœŸå®çš„webpackä¼šæ¯”è¿™é‡Œå¤æ‚å¾ˆå¤šå¾ˆå¤šã€‚è¿™é‡Œä¸ºäº†æ–¹ä¾¿å¤§å®¶ç†è§£åˆ»æ„è¿›è¡Œäº†ç®€åŒ–ï¼Œä½†æ˜¯æ ¸å¿ƒå·¥ä½œæµæ˜¯å’Œæºç ä¸­åŸºæœ¬ä¸€è‡´çš„ã€‚")]),e._v(" "),t("blockquote",[t("p",[e._v("è½¬è‡ªï¼šhttps://juejin.cn/post/7031546400034947108#heading-0")])])])}),[],!1,null,null,null);n.default=o.exports}}]);